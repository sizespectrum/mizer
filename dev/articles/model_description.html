<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The General Mizer Size-spectrum Model • mizer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The General Mizer Size-spectrum Model">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mizer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.5.1.9003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/mizer.html">Get started</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mizer.course.sizespectrum.org">Course</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/model_description.html">The General Mizer Size-spectrum Model</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/single_species_size-spectrum_dynamics.html">Single-species size-spectrum dynamics</a></li>
    <li><a class="dropdown-item" href="../articles/community_model.html">The Community Model</a></li>
    <li><a class="dropdown-item" href="../articles/trait_model.html">The Trait-Based Model</a></li>
    <li><a class="dropdown-item" href="../articles/multispecies_model.html">The Multi Species Model</a></li>
    <li><a class="dropdown-item" href="../articles/running_a_simulation.html">Running a Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/exploring_the_simulation_results.html">Exploring the Simulation Results</a></li>
    <li><a class="dropdown-item" href="../articles/a_multispecies_model_of_the_north_sea.html">A Multi-Species Model of the North Sea</a></li>
    <li><a class="dropdown-item" href="../articles/plotting.html">Using ggplot2 and plotly with mizer</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Publications</h6></li>
    <li><a class="dropdown-item" href="../articles/publications.html">Publications</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>For developers</h6></li>
    <li><a class="dropdown-item" href="../articles/developer_vignette.html">Developer Guide</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_git.html">Working with git and GitHub</a></li>
    <li><a class="dropdown-item" href="../articles/developer_FAQ.html">Developer FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/editing_website.html">Editing the Mizer Website</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://blog.mizer.sizespectrum.org">Blog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/mizer_model" aria-label="Twitter"><span class="fa fab fa-twitter fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sizespectrum/mizer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>The General Mizer Size-spectrum Model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sizespectrum/mizer/blob/HEAD/vignettes/model_description.Rmd" class="external-link"><code>vignettes/model_description.Rmd</code></a></small>
      <div class="d-none name"><code>model_description.Rmd</code></div>
    </div>

    
    
<p>On this page we present the details of the mizer model, taking care
to separate the essential features of the model that are hard-coded and
the various possible specialisations for which mizer provides setup
functions. We will provide links to the functions that can be used to
set or change the various model parameters (all collected together in
<code><a href="../reference/setParams.html">setParams()</a></code>) as well as to the functions that calculate the
various ecological rates in the model (all collected together in
<code><a href="../reference/mizerRates.html">mizerRates()</a></code>) because the help pages of these functions
will provide useful additional details.</p>
We will not go into detail of how this model is realised in code. Such
detail will be provided in the <a href="https://sizespectrum.org/mizer/articles/developer_vignette.html">developer
guide</a>. However some details are hidden on this page and you can see
them by clicking on links like the following:
<details>
And clicking again will hide the details again.
</details><div class="section level2">
<h2 id="size-spectrum-dynamics">Size spectrum dynamics<a class="anchor" aria-label="anchor" href="#size-spectrum-dynamics"></a>
</h2>
<div class="section level3">
<h3 id="consumer-densities">Consumer densities<a class="anchor" aria-label="anchor" href="#consumer-densities"></a>
</h3>
<p>The model assumes that, to a first approximation, an individual can
be characterized by its weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
and its species number
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
only. The aim of the model is to calculate the size spectrum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N_i(w)</annotation></semantics></math>,
which is the <em>density</em> of individuals of species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∫</mo><mi>w</mi><mrow><mi>w</mi><mo>+</mo><mi>d</mi><mi>w</mi></mrow></msubsup><msub><mi>N</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>w</mi></mrow><annotation encoding="application/x-tex">\int_w^{w+dw}N_i(w)dw</annotation></semantics></math>
is the <em>number</em> of individuals of species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
in the size interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>w</mi><mo>,</mo><mi>w</mi><mo>+</mo><mi>d</mi><mi>w</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[w,w+dw]</annotation></semantics></math>.
In other words: the number of individuals in a size range is the area
under the number density
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N_i(w)</annotation></semantics></math>.</p>
<details><p>Here is a plot of an example size spectrum for two species with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N_i(w)</annotation></semantics></math>
on the vertical axis for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">i=1,2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
on the horizontal axis.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sizespectrum.org/mizer/">mizer</a></span><span class="op">)</span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/newTraitParams.html">newTraitParams</a></span><span class="op">(</span>no_sp <span class="op">=</span> <span class="fl">2</span>, min_w <span class="op">=</span> <span class="fl">1e-3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotSpectra.html">plotSpectra</a></span><span class="op">(</span><span class="va">params</span>, resource <span class="op">=</span> <span class="cn">FALSE</span>, power <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="model_description_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>To represent this continuous size spectrum in the computer, the size
variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
is discretized into a vector <code>w</code> of discrete weights,
providing a grid of sizes spanning the range from the smallest egg size
to the largest maximum size. These grid values divide the full size
range into a finite number of size bins. The size bins should be chosen
small enough to avoid the discretisation errors from becoming too big.
You can fetch this vector with <code><a href="../reference/w.html">w()</a></code> and the vector of bin
sizes with <code><a href="../reference/w.html">dw()</a></code>.</p>
<p>The weight grid is set up to be logarithmically spaced, so that
<code>w[j]=w[1]*10^(j*dx)</code> for some fixed <code>dx</code>. This
means that the bin widths increase with size:
<code>dw[j] = w[j+1] - w[j] = w[j] * (10^dx - 1)</code>. This grid is
set up automatically when creating a MizerParams object.</p>
<p>In the code the size spectrum is stored as an array <code>N</code>
such that <code>N[i, a]</code> holds the density
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>a</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N_i(w_a)</annotation></semantics></math>
at weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>a</mi></msub><mo>=</mo></mrow><annotation encoding="application/x-tex">w_a=</annotation></semantics></math><code>w[a]</code>,
or, if time dependence is included, an array such that
<code>N[i, a, u]</code> holds
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>a</mi></msub><mo>,</mo><msub><mi>t</mi><mi>u</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N_i(w_a,t_u)</annotation></semantics></math>.
See <code><a href="../reference/N.html">N()</a></code>.</p>
<p>Note that, contrary to what one might have expected,
<code>N[i, a]</code> is not the <em>number</em> of individuals in a size
bin but the <em>density</em> at a grid point. The number of individuals
in the size bin between <code>w[a]</code> and
<code>w[a+1]=w[a]+dw[a]</code> is only approximately given as
<code>N[i, a]*dw[a]</code>, where <code>dw[a]= w[a+1]-w[a]</code>.</p>
<p>Of course all these calculations with discrete sizes and size bins
are only giving approximations to the continuous values, and these
approximations get better the smaller the size bins are, i.e., the more
size bins are used. This is why the functions setting up MizerParams
objects allow you to choose the number of size bins
<code>no_w</code>.</p>
</details>
</div>
<div class="section level3">
<h3 id="traffic-on-the-road-to-adulthood">Traffic on the road to adulthood<a class="anchor" aria-label="anchor" href="#traffic-on-the-road-to-adulthood"></a>
</h3>
<p>A good way to think about the time evolution of the number density
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N_i(w)</annotation></semantics></math>
is to consider the familiar situation of traffic density on the roads. A
fish’s life is a journey along the size axis from egg size to size at
death. There are many other fish making the same journey. The speed with
which the fish move along the size axis is their growth rate. This is
quite analogous to the speed of traffic on a road. Just as the speed of
cars depends on the density of other cars on the road, the growth rate
of fish depends on the density of other fish. When the density of cars
on a stretch of road is high, their speed decreases, and this leads to a
pile-up and can lead to traffic jams. Similarly when the density of fish
in a size interval is high, their growth rate goes down due to
competition for the same food sources, and this too can lead to pile-ups
and bottlenecks. So one just has to replace the space variable in a
traffic model by size to get an equation for the fish size spectra.</p>
<p>The additional feature in the evolution of fish densities that is not
present in road traffic density is that fish can die while they are
growing up, and this death rate is also dependent on the density of
other fish.</p>
<p>The time evolution of the number density
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N_i(w)</annotation></semantics></math>
is described by the McKendrick-von Foerster equation, which is a
transport equation (as one would use for traffic density) but with an
additional loss term due to fish mortality:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>∂</mi><msub><mi>N</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi>∂</mi><msub><mi>g</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>N</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>∂</mi><mi>w</mi></mrow></mfrac><mo>=</mo><mo>−</mo><msub><mi>μ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>N</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
  \label{eq:MvF}
  \frac{\partial N_i(w)}{\partial t} + \frac{\partial g_i(w) N_i(w)}{\partial w} 
  = -\mu_i(w) N_i(w),
\end{equation}</annotation></semantics></math></p>
<p>where individual growth
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_i(w)</annotation></semantics></math>
is described below in the <a href="#growth">Growth</a> section and
mortality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu_i(w)</annotation></semantics></math>
is described in the <a href="#mortality">Mortality</a> section.</p>
<p>There is no need for you to understand the mathematical notation used
in this equation to understand its origin: it just says that the rate at
which the number of fish in a size bracket changes is the rate at which
fish grow into the size bracket from a smaller size minus the rate at
which fish grow out of it to a larger size minus the rate at which the
fish in the size bracket die. So to simulate the size spectrum dynamics
we need to specify the growth rates and the mortality rates. This we
will do below. The important point is that these rates depend on the
density of other fish of other sizes, making the size-spectrum dynamics
non-linear and non-local in very interesting ways. The resulting effects
are too complicated to disentangle by pure thought. This is where
simulations with the mizer package come in.</p>
<p>This McKendrick-von Foerster equation is approximated in mizer by a
finite-difference method. This allows the <code><a href="../reference/project.html">project()</a></code>
function in mizer to project the size spectrum forwards in time: Given
the spectrum at one time the <code><a href="../reference/project.html">project()</a></code> function calculates
it at a set of later times.</p>
<p>Of course there also needs to be reproduction into the smallest size
class, otherwise there would be no small fish any more after a while. So
for the smallest size class instead of a rate of growth into the size
class there is a rate of reproduction of new individuals into that size
class. This reproduction will be described below in the <a href="#reproduction">Reproduction</a> section.</p>
</div>
<div class="section level3">
<h3 id="resource-density">Resource density<a class="anchor" aria-label="anchor" href="#resource-density"></a>
</h3>
<p>Besides the fish spectrum there is also a resource spectrum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>R</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N_R(w)</annotation></semantics></math>,
representing for example the phytoplankton. This spectrum starts at a
smaller size than the fish spectrum, in order to provide food also for
the smallest individuals (larvae) of the fish spectrum. By default the
time evolution of the resource spectrum is described by a semi-chemostat
equation.</p>
<details><p>The semichemostat dynamics are given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>∂</mi><msub><mi>N</mi><mi>R</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mi>r</mi><mi>R</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.8" maxsize="1.8" stretchy="false" form="prefix">[</mo><msub><mi>c</mi><mi>R</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>N</mi><mi>R</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.8" maxsize="1.8" stretchy="false" form="postfix">]</mo><mo>−</mo><msub><mi>μ</mi><mi>R</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>N</mi><mi>R</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
  \label{eq:nb}
  \frac{\partial N_R(w,t)}{\partial t} 
  = r_R(w) \Big[ c_R (w) - N_R(w,t) \Big] - \mu_R(w) N_R(w,t).
\end{equation}</annotation></semantics></math> Here
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>R</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">r_R(w)</annotation></semantics></math>
is the resource regeneration rate and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>R</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c_R(w)</annotation></semantics></math>
is the carrying capacity in the absence of predation. These parameters
are changed with <code><a href="../reference/setResource.html">setResource()</a></code>. By default mizer assumes
allometric forms
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>R</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>r</mi><mi>R</mi></msub><mspace width="0.167em"></mspace><msup><mi>w</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">r_R(w)= r_R\, w^{n-1}.</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>R</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>κ</mi><mspace width="0.167em"></mspace><msup><mi>w</mi><mrow><mo>−</mo><mi>λ</mi></mrow></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">c_R(w)=\kappa\, w^{-\lambda}.</annotation></semantics></math>
You can retrieve these with <code><a href="../reference/getResourceDynamics.html">getResourceRate()</a></code> and
<code><a href="../reference/getResourceDynamics.html">getResourceCapacity()</a></code> respectively. It is also possible to
implement other resource dynamics, as described in the help page for
<code><a href="../reference/setResource.html">setResource()</a></code>. The mortality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>R</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu_R(w)</annotation></semantics></math>
is due to predation by consumers and is described in the subsection <a href="#resource-mortality">Resource mortality</a>.</p>
<p>Because the resource spectrum spans a larger range of sizes these
sizes Because the resource spectrum spans a larger range of sizes these
sizes Because the resource spectrum spans a larger range of sizes these
sizes are discretized into a different vector of weights</p>
<p>The resource spectrum is then represented by a vector
<code>NResource</code> such that <code>NResource[c]</code>
=<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>R</mi></msub><mo stretchy="false" form="prefix">(</mo></mrow><annotation encoding="application/x-tex">N_R(</annotation></semantics></math><code>w_full[c]</code><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo stretchy="false" form="postfix">)</mo><annotation encoding="application/x-tex">)</annotation></semantics></math>.</p>
</details>
</div>
</div>
<div class="section level2">
<h2 id="growth">Growth<a class="anchor" aria-label="anchor" href="#growth"></a>
</h2>
<p>Consumers can grow only by consuming prey. In the next few
subsections we will build towards determining the growth rate resulting
from predation. We will discuss how we model the <a href="#sec:pref">predator-prey encounter rate</a>, the resulting rate of
<a href="#consumption">consumption</a>, the rate of <a href="#metabolic-losses">metabolic losses</a>, and the partitioning of
the remaining energy into <a href="#sec:repro">reproduction</a> and <a href="#resulting-growth">growth</a>.</p>
<div class="section level3">
<h3 id="sec:pref">Predator-prey encounter rate<a class="anchor" aria-label="anchor" href="#sec:pref"></a>
</h3>
<p>The rate at which a predator of species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
encounters food (mass per time) is determined by summing over all prey
species and the resource spectrum and integrating over all prey sizes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>p</mi></msub><annotation encoding="application/x-tex">w_p</annotation></semantics></math>,
weighted by the selectivity factors:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>γ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∫</mo><mrow><mo stretchy="true" form="prefix">(</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>θ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>N</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>θ</mi><mrow><mi>i</mi><mi>R</mi></mrow></msub><msub><mi>N</mi><mi>R</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ϕ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><msub><mi>w</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>w</mi><mi>p</mi></msub><mspace width="0.167em"></mspace><mi>d</mi><msub><mi>w</mi><mi>p</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
  \label{eq:1}
  E_{i}(w) = \gamma_i(w) \int \left(\sum_{j} \theta_{ij} N_j(w_p) +
   \theta_{iR} N_R(w_p) \right) 
  \phi_i(w,w_p) w_p \, dw_p.
\end{equation}</annotation></semantics></math> This is calculated by
<code><a href="../reference/getEncounter.html">getEncounter()</a></code>. The overall prefactor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\gamma_i(w)</annotation></semantics></math>
sets the predation power of the predator. It could be interpreted as a
search volume. It is set by <code><a href="../reference/setSearchVolume.html">setSearchVolume()</a></code>. By default
it is assumed to scale allometrically as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>γ</mi><mi>i</mi></msub><mspace width="0.167em"></mspace><msup><mi>w</mi><mi>q</mi></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">\gamma_i(w) = \gamma_i\, w^q.</annotation></semantics></math></p>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
matrix sets the interaction strength between predators and the various
prey species and resource. It is changed with
<code><a href="../reference/setInteraction.html">setInteraction()</a></code>.</p>
<p>The size selectivity is encoded in the predation kernel
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><msub><mi>w</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\phi_i(w,w_p)</annotation></semantics></math>.
This is changed with <code><a href="../reference/setPredKernel.html">setPredKernel()</a></code>.</p>
<details><p>An important simplification occurs when the predation kernel
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><msub><mi>w</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\phi_i(w,w_p)</annotation></semantics></math>
depends on the size of the prey <strong>only</strong> through the
predator/prey size ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>p</mi></msub><mi>/</mi><mi>w</mi></mrow><annotation encoding="application/x-tex">w_p/w</annotation></semantics></math>,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><msub><mi>w</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mover><mi>ϕ</mi><mo accent="true">̃</mo></mover><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mi>/</mi><msub><mi>w</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\phi_i(w, w_p)=\tilde{\phi}_i(w/w_p).</annotation></semantics></math>
This is assumed by default but can be overruled. The default for the
predation kernel is the truncated log-normal function
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>ϕ</mi><mo accent="true">̃</mo></mover><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mo>exp</mo><mrow><mo stretchy="true" form="prefix">[</mo><mfrac displaystyle="true"><mrow><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mi>/</mi><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><mrow><mn>2</mn><msubsup><mi>σ</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> if </mtext><mspace width="0.333em"></mspace></mrow><mi>x</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><msub><mi>β</mi><mi>i</mi></msub><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>3</mn><msub><mi>σ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> otherwise,</mtext></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
  \label{eq:4}
  \tilde{\phi}_i(x) = \begin{cases}
  \exp \left[ \dfrac{-(\ln(x / \beta_i))^2}{2\sigma_i^2} \right]
  &amp;\text{ if }x\in\left[0,\beta_i\exp(3\sigma_i)\right]\\
  0&amp;\text{ otherwise,}
  \end{cases}
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\beta_i</annotation></semantics></math>
is the preferred predator-prey mass ratio and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\sigma_i</annotation></semantics></math>
sets the width of the predation kernel.</p>
<p>The integral in the expression for the encounter rate is approximated
by a Riemann sum over all weight brackets: <span class="math display">$$
{\tt encounter}[i,a] = {\tt search\_vol}[i,a]\sum_{k}
\left( n_{R}[k] + \sum_{j} \theta[i,j] n[j,k] \right)
  \phi_i\left(w[a],w[k]\right) w[k]\, dw[k].
$$</span> In the case of a predation kernel that depends on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi>/</mi><msub><mi>w</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">w/w_p</annotation></semantics></math>
only, this becomes a convolution sum and can be evaluated efficiently
via fast Fourier transform.</p>
</details>
</div>
<div class="section level3">
<h3 id="consumption">Consumption<a class="anchor" aria-label="anchor" href="#consumption"></a>
</h3>
<p>The encountered food is consumed subject to a standard Holling
functional response type II to represent satiation. This determines the
<em>feeding level</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f_i(w)</annotation></semantics></math>,
which is a dimensionless number between 0 (no food) and 1 (fully
satiated) so that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><msub><mi>f</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1-f_i(w)</annotation></semantics></math>
is the proportion of the encountered food that is consumed. The feeding
level is given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>E</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>E</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>h</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
  \label{eq:f}
  f_i(w) = \frac{E_i(w)}{E_i(w) + h_i(w)},
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h_i(w)</annotation></semantics></math>
is the maximum consumption rate. This is changed with
<code><a href="../reference/setMaxIntakeRate.html">setMaxIntakeRate()</a></code>. By default mizer assumes an allometric
form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>h</mi><mi>i</mi></msub><mspace width="0.167em"></mspace><msup><mi>w</mi><mi>n</mi></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">h_i(w) = h_i\, w^n.</annotation></semantics></math>
The feeding level is calculated with the function
<code><a href="../reference/getFeedingLevel.html">getFeedingLevel()</a></code>.</p>
<p>The rate at which food is consumed is then
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>f</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>E</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>f</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><msub><mi>h</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
(1-f_i(w))E_{i}(w)=f_i(w)\, h_i(w).
\end{equation}</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="metabolic-losses">Metabolic losses<a class="anchor" aria-label="anchor" href="#metabolic-losses"></a>
</h3>
<p>Some of the consumed food is used to fuel the needs for metabolism
and activity and movement, at a rate <span class="math inline">${\tt
metab}_i(w)$</span>. By default this is made up out of standard
metabolism, scaling with exponent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>,
and loss due to activity and movement, scaling with exponent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>:
<span class="math display">$${\tt metab}_i(w) = k_{s.i}\,w^p +
k_i\,w.$$</span> See the help page for
<code><a href="../reference/setMetabolicRate.html">setMetabolicRate()</a></code>.</p>
<p>The remaining rate, if any, is assimilated with an efficiency
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\alpha_i</annotation></semantics></math>
and is then available for growth and reproduction. So the rate at which
energy becomes available for growth and reproduction is <span class="math display">$$\begin{equation}
  \label{eq:Er}
  E_{r.i}(w) = \max(0, \alpha_i f_i(w)\, h_i(w) - {\tt metab}_i(w))
\end{equation}$$</span> This is calculated with the
<code><a href="../reference/getEReproAndGrowth.html">getEReproAndGrowth()</a></code> function.</p>
</div>
<div class="section level3">
<h3 id="sec:repro">Investment into reproduction<a class="anchor" aria-label="anchor" href="#sec:repro"></a>
</h3>
<p>A proportion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\psi_i(w)</annotation></semantics></math>
of the energy available for growth and reproduction is used for
reproduction. This proportion should change from zero below the weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mrow><mi>m</mi><mi>.</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">w_{m.i}</annotation></semantics></math>
of maturation to one at the maximum weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mi>.</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">w_{max.i}</annotation></semantics></math>,
where all available energy is used for reproduction. This function is
changed with <code><a href="../reference/setReproduction.html">setReproduction()</a></code>. Mizer provides a default
form for the function which you can however overrule.</p>
</div>
<div class="section level3">
<h3 id="growth-1">Growth<a class="anchor" aria-label="anchor" href="#growth-1"></a>
</h3>
<p>What is left over after metabolism and reproduction is taken into
account is invested in somatic growth. Thus the growth rate is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>E</mi><mrow><mi>r</mi><mi>.</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>ψ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
  \label{eq:growth}
  g_i(w) = E_{r.i}(w)\left(1-\psi_i(w)\right).
\end{equation}</annotation></semantics></math> It is calculated by the
<code><a href="../reference/getEGrowth.html">getEGrowth()</a></code> function.</p>
<p>When food supply does not cover the requirements of metabolism and
activity, growth and reproduction stops, i.e. there is no negative
growth. The individual should then be subjected to a starvation
mortality, but starvation mortality is not implemented in core mizer but
is provided by the <a href="https://sizespectrum.org/mizerStarvation">mizerStarvation</a>
extension package.</p>
</div>
</div>
<div class="section level2">
<h2 id="mortality">Mortality<a class="anchor" aria-label="anchor" href="#mortality"></a>
</h2>
<p>The mortality rate of an individual
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu_i(w)</annotation></semantics></math>
has three sources: predation mortality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mrow><mi>p</mi><mi>.</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu_{p.i}(w)</annotation></semantics></math>,
background mortality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mrow><mi>e</mi><mi>x</mi><mi>t</mi><mi>.</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu_{ext.i}(w)</annotation></semantics></math>
and fishing mortality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mrow><mi>f</mi><mi>.</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu_{f.i}(w)</annotation></semantics></math>.</p>
<p>Predation mortality is calculated such that all that is eaten
translates into corresponding predation mortalities on the ingested prey
individuals. Recalling that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><msub><mi>f</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1-f_j(w)</annotation></semantics></math>
is the proportion of the food encountered by a predator of species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
and weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
that is actually consumed, the rate at which all predators of species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
consume prey of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>p</mi></msub><annotation encoding="application/x-tex">w_p</annotation></semantics></math>
is <span class="math display">$$\begin{equation}
  \label{eq:pred_rated}
  {\tt pred\_rate}_j(w_p) = \int \phi_j(w,w_p) (1-f_j(w))
  \gamma_j(w) N_j(w) \, dw.
\end{equation}$$</span> This predation rate is calculated by the
function <code><a href="../reference/getPredRate.html">getPredRate()</a></code>.</p>
<details><p>The integral is approximated by a Riemann sum over all fish weight
brackets. <span class="math display">$$
{\tt pred\_rate}[j,c] = \sum_{a}
  {\tt pred_kernel}[j,a,c]\,(1-{\tt feeding_level}[j,a])\,
  \gamma[j,a]\,n[j,a]\,dw[a].
$$</span></p>
</details><p>The mortality rate due to predation is then obtained as <span class="math display">$$\begin{equation}
  \label{eq:mup}
  \mu_{p.i}(w_p) = \sum_j {\tt pred\_rate}_j(w_p)\, \theta_{ji}.
\end{equation}$$</span> This predation mortality rate is calculated by
the function <code><a href="../reference/getPredMort.html">getPredMort()</a></code>.</p>
<p>External mortality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mrow><mi>e</mi><mi>x</mi><mi>t</mi><mi>.</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu_{ext.i}(w)</annotation></semantics></math>
is independent of the abundances and is changed with
<code><a href="../reference/setExtMort.html">setExtMort()</a></code>. By default mizer assumes that the external
mortality for each species is a constant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><msub><mn>0</mn><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">z0_i</annotation></semantics></math>
independent of size. The value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><msub><mn>0</mn><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">z0_i</annotation></semantics></math>
is either specified as a species parameter or it is assumed to depend
allometrically on the maximum size:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><msub><mn>0</mn><mi>i</mi></msub><mo>=</mo><mi>z</mi><msub><mn>0</mn><mrow><mi>p</mi><mi>r</mi><mi>e</mi></mrow></msub><msubsup><mi>w</mi><mrow><mi>∞</mi><mi>.</mi><mi>i</mi></mrow><mrow><mn>1</mn><mo>−</mo><mi>n</mi></mrow></msubsup><mi>.</mi></mrow><annotation encoding="application/x-tex">z0_i = z0_{pre} w_{\infty.i}^{1-n}.</annotation></semantics></math></p>
<div class="section level3">
<h3 id="fishing-mortality">Fishing mortality<a class="anchor" aria-label="anchor" href="#fishing-mortality"></a>
</h3>
<p>The fishing parameters for the model are set up with
<code><a href="../reference/setFishing.html">setFishing()</a></code>, where you can find the details of how to set
up gears with different selectivities and the capabilities of different
species. Fishing mortality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mrow><mi>f</mi><mi>.</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu_{f.i}(w)</annotation></semantics></math>
is calculated with the function <code><a href="../reference/getFMort.html">getFMort()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="total-mortality">Total mortality<a class="anchor" aria-label="anchor" href="#total-mortality"></a>
</h3>
<p>The total mortality rate
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>μ</mi><mrow><mi>p</mi><mi>.</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>μ</mi><mrow><mi>e</mi><mi>x</mi><mi>t</mi><mo>,</mo><mi>u</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>μ</mi><mrow><mi>f</mi><mi>.</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu_i(w)=\mu_{p.i}(w)+\mu_{ext,u}(w)+\mu_{f.i}(w)</annotation></semantics></math>
is calculated with the function <code><a href="../reference/getMort.html">getMort()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="resource-mortality">Resource Mortality<a class="anchor" aria-label="anchor" href="#resource-mortality"></a>
</h3>
<p>The predation mortality rate on resource is given by a similar
expression as the predation mortality on fish: <span class="math display">$$\begin{equation}
  \label{eq:mupp}
  \mu_{p}(w_p) = \sum_j {\tt pred\_rate}_j(w_p)\, \theta_{jp}.
\end{equation}$$</span> This is the only mortality on resource currently
implemented in mizer. It is calculated with the function
<code><a href="../reference/getResourceMort.html">getResourceMort()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="reproduction">Reproduction<a class="anchor" aria-label="anchor" href="#reproduction"></a>
</h2>
<div class="section level3">
<h3 id="energy-invested-into-reproduction">Energy invested into reproduction<a class="anchor" aria-label="anchor" href="#energy-invested-into-reproduction"></a>
</h3>
<p>The total rate of investment into reproduction (grams/year) is found
by integrating the contribution from all individuals of species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
each of which invests a proportion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\psi_i(w)</annotation></semantics></math>
of their consumption. This total rate of energy investment can then be
converted to a total rate of egg production
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mrow><mi>p</mi><mi>.</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">R_{p.i}</annotation></semantics></math>
(numbers per year):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mrow><mi>p</mi><mi>.</mi><mi>i</mi></mrow></msub><mo>=</mo><mfrac><mi>ϵ</mi><mrow><mn>2</mn><msub><mi>w</mi><mn>0</mn></msub></mrow></mfrac><mo>∫</mo><msub><mi>N</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>E</mi><mrow><mi>r</mi><mi>.</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ψ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>w</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
  \label{eq:Rp}
  R_{p.i} = \frac{\epsilon}{2 w_0} \int N_i(w)  E_{r.i}(w) \psi_i(w) \, dw,
\end{equation}</annotation></semantics></math> Here the total rate of
investment is multiplied by an efficiency factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϵ</mi><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math>
and then dividing by the egg weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>0</mn></msub><annotation encoding="application/x-tex">w_0</annotation></semantics></math>
to convert the energy into number of eggs. The result is multiplied by a
factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">1/2</annotation></semantics></math>
to take into account that only females reproduce. This rate of potential
egg production is calculated with <code><a href="../reference/getRDI.html">getRDI()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="density-dependence-in-reproduction">Density-dependence in reproduction<a class="anchor" aria-label="anchor" href="#density-dependence-in-reproduction"></a>
</h3>
<p>Three important density-dependent mechanisms widely assumed in
fisheries models are automatically captured in the mizer model that lead
to an emergent stock-recruitment relationship:</p>
<ol style="list-style-type: decimal">
<li>High density of spawners leads to a reduced food income of the
spawners and consequently reduced per-capita reproduction.</li>
<li>High density of larvae leads to slower growth of larvae due to food
competition, exposing the larvae to high mortality for a longer time,
thereby decreasing the survivorship to recruitment size.</li>
<li>High density of fish leads to more predation on eggs and fish larvae
by other fish species or by cannibalism.</li>
</ol>
<p>However there are other sources of density dependence that are not
explicitly modelled mechanistically in mizer. An example would be a
limited carrying capacity of suitable spawning grounds and other spatial
effects.</p>
<p>This requires additional phenomenological density dependent
contributions to the stock-recruitment. In mizer this type of density
dependence is modelled through constraints on egg production and
survival. The default functional form of this density dependence is
represented by a reproduction rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>i</mi></msub><annotation encoding="application/x-tex">R_i</annotation></semantics></math>
(numbers per time) that approaches a maximum as the energy invested in
reproduction increases, modelled mathematically it is analogous to a
<em>Beverton-Holt</em> type function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>i</mi></msub><mo>=</mo><msub><mi>R</mi><mrow><mo>max</mo><mi>.</mi><mi>i</mi></mrow></msub><mfrac><msub><mi>R</mi><mrow><mi>p</mi><mi>.</mi><mi>i</mi></mrow></msub><mrow><msub><mi>R</mi><mrow><mi>p</mi><mi>.</mi><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>R</mi><mrow><mo>max</mo><mi>.</mi><mi>i</mi></mrow></msub></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
  \label{eq:R}
  R_i = R_{\max.i} \frac{R_{p.i}}{R_{p.i} + R_{\max.i}},
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mrow><mo>max</mo><mi>.</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">R_{\max.i}</annotation></semantics></math>
is the maximum reproduction rate of each trait class. This final rate of
reproduction is calculated with <code><a href="../reference/getRDD.html">getRDD()</a></code>.</p>
<p>This default <em>Beverton-Holt</em> type is implemented by
<code>BervertonHoldRDD()</code> but mizer also provides alternatives
<code><a href="../reference/RickerRDD.html">RickerRDD()</a></code>, <code><a href="../reference/SheperdRDD.html">SheperdRDD()</a></code>,
<code><a href="../reference/constantRDD.html">constantRDD()</a></code> and <code><a href="../reference/noRDD.html">noRDD()</a></code>. Also, users are
able to write their own functions, e.g. <em>hockey-stick</em>. See
<code><a href="../reference/setReproduction.html">setReproduction()</a></code> for details.</p>
</div>
<div class="section level3">
<h3 id="abundance-at-egg-size">Abundance at egg size<a class="anchor" aria-label="anchor" href="#abundance-at-egg-size"></a>
</h3>
<p>The reproduction rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>i</mi></msub><annotation encoding="application/x-tex">R_i</annotation></semantics></math>
determines the abundance density of species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
at egg size. Intuitively, the rate at which individuals of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>0</mn></msub><annotation encoding="application/x-tex">w_0</annotation></semantics></math>
is produced must equal the rate at which they grow away from size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>0</mn></msub><annotation encoding="application/x-tex">w_0</annotation></semantics></math>,
which gives
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msub><mi>R</mi><mi>i</mi></msub><mrow><msub><mi>g</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">N_i(w_0) = \frac{R_i}{g_i(w_0)}.</annotation></semantics></math></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.york.ac.uk/maths/staff/gustav-delius/" class="external-link">Gustav Delius</a>, Finlay Scott, <a href="http://www.utas.edu.au/profiles/staff/imas/julia-blanchard" class="external-link">Julia Blanchard</a>, <a href="https://ken.haste.dk/" class="external-link">Ken Andersen</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
