<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The Trait-Based Model • mizer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The Trait-Based Model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mizer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.5.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/mizer.html">Get started</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mizer.course.sizespectrum.org">Course</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/model_description.html">The General Mizer Size-spectrum Model</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/single_species_size-spectrum_dynamics.html">Single-species size-spectrum dynamics</a></li>
    <li><a class="dropdown-item" href="../articles/community_model.html">The Community Model</a></li>
    <li><a class="dropdown-item" href="../articles/trait_model.html">The Trait-Based Model</a></li>
    <li><a class="dropdown-item" href="../articles/multispecies_model.html">The Multi Species Model</a></li>
    <li><a class="dropdown-item" href="../articles/running_a_simulation.html">Running a Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/exploring_the_simulation_results.html">Exploring the Simulation Results</a></li>
    <li><a class="dropdown-item" href="../articles/a_multispecies_model_of_the_north_sea.html">A Multi-Species Model of the North Sea</a></li>
    <li><a class="dropdown-item" href="../articles/plotting.html">Using ggplot2 and plotly with mizer</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Publications</h6></li>
    <li><a class="dropdown-item" href="../articles/publications.html">Publications</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>For developers</h6></li>
    <li><a class="dropdown-item" href="../articles/developer_vignette.html">Developer Guide</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_git.html">Working with git and GitHub</a></li>
    <li><a class="dropdown-item" href="../articles/developer_FAQ.html">Developer FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/editing_website.html">Editing the Mizer Website</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://blog.mizer.sizespectrum.org">Blog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/mizer_model" aria-label="Twitter"><span class="fa fab fa-twitter fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sizespectrum/mizer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>The Trait-Based Model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sizespectrum/mizer/blob/HEAD/vignettes/trait_model.Rmd" class="external-link"><code>vignettes/trait_model.Rmd</code></a></small>
      <div class="d-none name"><code>trait_model.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The trait-based size spectrum model can be derived as a
simplification of the general model outline in the <a href="model_description.html">model description</a> section. It is more
complicated than a <a href="community_model.html">community model</a>
and the most significant difference between the two is that while the
community model aggregates all species into a single spectrum, the
trait-based model resolves many species.</p>
<p>In a trait-based model the maximum size is considered to be the most
important <em>trait</em> characterizing a species. Most of the
species-specific parameters, such as <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\sigma\)</span>, are the same for all species.
Other model parameters are determined by the maximum size. For example,
the weight at maturation is a fixed fraction of the maximum size. The
maximum sizes of the species are spread evenly on a logarithmic scale.
The number of species is not important and does not affect the general
dynamics of the model.</p>
</div>
<div class="section level2">
<h2 id="sec:set_up_trait_model">Setting up a trait-based model<a class="anchor" aria-label="anchor" href="#sec:set_up_trait_model"></a>
</h2>
<p>To help set up a trait-based model, there is a wrapper function,
<code><a href="../reference/newTraitParams.html">newTraitParams()</a></code>. Like the
<code><a href="../reference/newCommunityParams.html">newCommunityParams()</a></code> function described in the section on
the <a href="community_model.html">community model</a>, this function
can take many arguments. Most of them have default values so you don’t
need to worry about them for the moment. See the help page for
<code><a href="../reference/newTraitParams.html">newTraitParams()</a></code> for more details.</p>
<p>One of the key differences between the community type model and the
trait-based model is that reproduction and egg production are
considered. In the community model, reproduction is constant and there
is no relationship between the abundance in the community and egg
production. In the trait-based model, the egg production is dependent on
mature individuals investing part of their energy income into
reproduction. The relationship between the energy invested into
reproduction and the actual rate of egg production is modelled using a
<em>Beverton-Holt</em> type function (the default in <code>mizer</code>,
see <a href="model_description.html#density-dependence-in-reproduction">the
section on density-dependence in reproduction</a>) where the
reproduction rate <span class="math inline">\(R_i\)</span> (numbers per
time) approaches a maximum as the energy invested increases.</p>
<p>Here we set up the model to have 10 species, with maximum sizes
ranging from 10 g to 100 kg. All the other parameters have default
values.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/newTraitParams.html">newTraitParams</a></span><span class="op">(</span>no_sp <span class="op">=</span> <span class="fl">10</span>, min_w_max <span class="op">=</span> <span class="fl">10</span>, max_w_max <span class="op">=</span> <span class="fl">1e5</span><span class="op">)</span></span></code></pre></div>
<p>This function returns an object of type <code>MizerParams</code> that
holds all the model information, including species parameters. This
object can therefore be interrogated in the same way as described in <a href="community_model.html">the section on the community model</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An object of class "MizerParams" </span></span>
<span><span class="co">## Consumer size spectrum:</span></span>
<span><span class="co">##  minimum size:   0.001</span></span>
<span><span class="co">##  maximum size:   1e+05</span></span>
<span><span class="co">##  no. size bins:  161</span></span>
<span><span class="co">## Resource size spectrum:</span></span>
<span><span class="co">##  minimum size:   1e-10</span></span>
<span><span class="co">##  maximum size:   2.23872</span></span>
<span><span class="co">##  no. size bins:  208 (301 size bins in total)</span></span>
<span><span class="co">## Species details:</span></span>
<span><span class="co">##    species        w_max        w_mat w_min  f0   fc beta sigma</span></span>
<span><span class="co">## 1        1 8.912509e+00     2.511886 0.001 0.6 0.25  100   1.3</span></span>
<span><span class="co">## 2        2 2.511886e+01     7.079458 0.001 0.6 0.25  100   1.3</span></span>
<span><span class="co">## 3        3 7.079458e+01    19.952623 0.001 0.6 0.25  100   1.3</span></span>
<span><span class="co">## 4        4 1.995262e+02    56.234133 0.001 0.6 0.25  100   1.3</span></span>
<span><span class="co">## 5        5 5.623413e+02   158.489319 0.001 0.6 0.25  100   1.3</span></span>
<span><span class="co">## 6        6 1.584893e+03   446.683592 0.001 0.6 0.25  100   1.3</span></span>
<span><span class="co">## 7        7 4.466836e+03  1258.925412 0.001 0.6 0.25  100   1.3</span></span>
<span><span class="co">## 8        8 1.258925e+04  3548.133892 0.001 0.6 0.25  100   1.3</span></span>
<span><span class="co">## 9        9 3.548134e+04 10000.000000 0.001 0.6 0.25  100   1.3</span></span>
<span><span class="co">## 10      10 1.000000e+05 28183.829313 0.001 0.6 0.25  100   1.3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fishing gear details:</span></span>
<span><span class="co">## Gear          Effort  Target species </span></span>
<span><span class="co">##  ----------------------------------</span></span>
<span><span class="co">## knife_edge_gear 0.00   1, 2, 3, 4, 5, 6, 7, 8, 9, 10</span></span></code></pre>
<p>The summary shows us that now we have 10 species in the model, with
maximum sizes ranging from <span class="math inline">\(8.9125094\)</span> to <span class="math inline">\(10^{5}\)</span>. The rather strange-looking values
for the sizes is due to the fact that the size classes are equally
spaced on a logarithmic scale.</p>
<p>The size at maturity (<code>w_mat</code>) is linearly related to the
maximum size. Each species has the same preferred predator-prey mass
ratio parameter values (<code>beta</code> and <code>sigma</code>, see <a href="model_description.html#sec:ppmr">the section on predator/prey mass
ratio</a>). There are <span class="math inline">\(161\)</span> size bins
in the community and <span class="math inline">\(301\)</span> size bins
including the resource spectrum. Ignore the summary section on fishing
gear for the moment. This is explained later.</p>
</div>
<div class="section level2">
<h2 id="sec:running_trait_model">Running the trait-based model<a class="anchor" aria-label="anchor" href="#sec:running_trait_model"></a>
</h2>
<p>As with the <a href="community_model.html">community model</a>, we
can project the trait-based model through time using the
<code><a href="../reference/project.html">project()</a></code> function. Here we project the model for 75 years
without any fishing (the <code>effort</code> argument is set to 0). We
use the default initial population abundances so there is no need to
pass in any initial population values (see <a href="running_a_simulation.html#sec:setting_initial_abundances">the
section on setting the initial abundances</a>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">params</span>, t_max <span class="op">=</span> <span class="fl">75</span>, effort <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>This results in a <code>MizerSim</code> object that contains the
abundances of the community and resource spectra through time, as well
as the original <code>MizerParams</code> object. As with the community
model, we can get a quick overview of the results of the simulation by
calling the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span></code></pre></div>
<p><img src="trait_model_files/figure-html/plot_comm_sim_2-1.png" alt="Summary plot of the trait-based model without fishing." width="700"></p>
<p>The summary plot has the same panels as the one generated by the
community model, but here you can see that all the species in the
community are plotted. The panels show the situation in the final time
step of the simulation, apart from the biomass through time plot. As
this is a trait-based model where all species fully interact with each
other, the predation mortality and feeding level by size is the same for
each species. In this simulation we turned fishing off so the fishing
mortality is 0. The size-spectra show the abundances at size to be
evenly spaced by log of maximum size.</p>
</div>
<div class="section level2">
<h2 id="sec:trophic_cascade_trait_model">Example of a trophic cascade with the trait-based model<a class="anchor" aria-label="anchor" href="#sec:trophic_cascade_trait_model"></a>
</h2>
<p>As with the community model, it is possible to use the trait-based
model to simulate a trophic cascade. Again, we perform two simulations,
one with fishing and one without. We therefore need to consider how
fishing gears and selectivity have been set up by the
<code><a href="../reference/newTraitParams.html">newTraitParams()</a></code> function.</p>
<p>The default fishing selectivity function is a knife-edge function,
which only selects individuals larger than 1000 g. There is also only
one fishing gear in operation, and this selects all of the species. You
can see this if you call the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method on the
<code>params</code> argument we set up above. At the bottom of the
summary there is a section on <em>Fishing gear details</em>. You can see
that there is only one gear, called <code>knife_edge_gear</code> and
that it selects species 1 to 10. To control the size at which
individuals are selected there is a <code>knife_edge_size</code>
argument to the <code><a href="../reference/newTraitParams.html">newTraitParams()</a></code> function. This has a
default value of 1000 g.</p>
<p>In <code>mizer</code> it is possible to include more than one fishing
gear in the model and for different species to be caught by different
gears. We will ignore this for now, but will explore it further below
when we introduce an industrial fishery to the trait-based model.</p>
<p>To set up the trait-based model to have fishing we set up the
<code>MizerParams</code> object in exactly the same way as we did before
but here the <code>knife_edge_size</code> argument is explicitly passed
in for clarity:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params_knife</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/newTraitParams.html">newTraitParams</a></span><span class="op">(</span>no_sp <span class="op">=</span> <span class="fl">10</span>, min_w_max <span class="op">=</span> <span class="fl">10</span>, max_w_max <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>    knife_edge_size <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>First we perform a simulation without fishing in the same way we did
above by setting the <code>effort</code> argument to 0:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">params_knife</span>, effort <span class="op">=</span> <span class="fl">0</span>, t_max <span class="op">=</span> <span class="fl">75</span><span class="op">)</span></span></code></pre></div>
<p>Now we simulate with fishing. Here, we use an effort of 0.75. As
mentioned in <a href="community_model.html#sec:trophic_cascade_comm_model">the section
on trophic cascades in the community model</a>, the fishing mortality on
a species is calculated as the product of effort, catchability and
selectivity (see <a href="multispecies_model.html#sec:fishing_gear">the
section on fishing gears</a> for more details). Selectivity ranges
between 0 (not selected) and 1 (fully selected). The default value of
catchability is 1. Therefore, in this simulation the fishing mortality
of a fully selected individual is simply equal to the effort. This
effort is constant throughout the duration of the simulation (however,
mizer does allow variable effort).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">params_knife</span>, effort <span class="op">=</span> <span class="fl">0.75</span>, t_max <span class="op">=</span> <span class="fl">75</span><span class="op">)</span></span></code></pre></div>
<p>Again, we can plot the summary of the fished community using the
default <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function. The knife-edge selectivity at 1000
g can be clearly seen in the fishing mortality panel:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim1</span><span class="op">)</span></span></code></pre></div>
<p><img src="trait_model_files/figure-html/plot_trait_fmort-1.png" alt="Summary plot of the trait-based model with fishing." width="700"></p>
<p>The trophic cascade can be explored by comparing the total abundances
of all species at size when the community is fished and unfished. As
mentioned above, we obtain the abundances with <code>N(sim)</code>,
which returns a three dimensional array with dimensions time x species x
size. Here we have 76 time steps (75 from the simulation plus one which
stores the initial population), 10 species and 100 sizes:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="../reference/N.html">N</a></span><span class="op">(</span><span class="va">sim0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  76  10 161</span></span></code></pre>
<p>As with the community model, we are interested in the relative total
abundances by size in the final time step so we use the
<code><a href="../reference/finalN.html">finalN()</a></code> function. This gives us a matrix with one row per
species and one column per size bin. We sum in each column to get a
vector with the total abundance per size bin:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">total_abund0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="../reference/finalN.html">finalN</a></span><span class="op">(</span><span class="va">sim0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">total_abund1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="../reference/finalN.html">finalN</a></span><span class="op">(</span><span class="va">sim1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can then use these vectors to calculate the relative
abundances:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">relative_abundance</span> <span class="op">&lt;-</span> <span class="va">total_abund1</span> <span class="op">/</span> <span class="va">total_abund0</span></span></code></pre></div>
<p>This can be plotted using the commands below:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="../reference/w.html">w</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">relative_abundance</span>, log <span class="op">=</span> <span class="st">"xy"</span>, type <span class="op">=</span> <span class="st">"n"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Size (g)"</span>, ylab <span class="op">=</span> <span class="st">"Relative abundance"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="../reference/w.html">w</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">relative_abundance</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="../reference/w.html">w</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="../reference/w.html">w</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="trait_model_files/figure-html/plot_relative_comm_abund2-1.png" alt="Relative abundances from the unfished (dashed line) and fished (solid line) trait-based model." width="700"></p>
<p>The impact of fishing on species larger than 1000 g can be clearly
seen. The fishing pressure lowers the abundance of large fish (<span class="math inline">\(&gt; 1000\)</span> g). This then relieves the
predation pressure on their smaller prey (the preferred predator-prey
size ratio is given by the <span class="math inline">\(\beta\)</span>
parameter, which is set to 100 by default), leading to an increase in
their abundance. This in turn increases the predation mortality on their
smaller prey, which reduces their abundance and so on.</p>
<p>This impact can also be seen by looking at the predation mortality by
size. The predation mortalities are retrieved using the
<code><a href="../reference/getPredMort.html">getPredMort()</a></code> function. As mentioned above, for the trait
based model the predation mortality by size is the same for each
species. Therefore we only look at the predation mortality of the first
species.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m2_no_fishing</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPredMort.html">getPredMort</a></span><span class="op">(</span><span class="va">params</span>, <span class="fu"><a href="../reference/finalN.html">finalN</a></span><span class="op">(</span><span class="va">sim0</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">m2_with_fishing</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPredMort.html">getPredMort</a></span><span class="op">(</span><span class="va">params</span>, <span class="fu"><a href="../reference/finalN.html">finalN</a></span><span class="op">(</span><span class="va">sim1</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span></span></code></pre></div>
<p>The predation mortalities can then be plotted.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="../reference/w.html">w</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">m2_with_fishing</span>, log <span class="op">=</span> <span class="st">"x"</span>, type <span class="op">=</span> <span class="st">"n"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Size [g]"</span>, ylab <span class="op">=</span> <span class="st">"Predation Mortality [1/year]"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="../reference/w.html">w</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">m2_no_fishing</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="../reference/w.html">w</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">m2_with_fishing</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="trait_model_files/figure-html/plot_relative_trait_m2-1.png" alt="Predation mortalities from the unfished (dashed line) and fished (solid line) trait-based model." width="700"><p class="caption">
Predation mortalities from the unfished (dashed line) and fished (solid
line) trait-based model.
</p>
</div>
</div>
<div class="section level2">
<h2 id="sec:trait_additional_gear">Setting up an industrial fishing gear<a class="anchor" aria-label="anchor" href="#sec:trait_additional_gear"></a>
</h2>
<p>In this section we want to operate an <em>industrial</em> fishery.
Industrial fishing targets the small zooplanktivorous species that are
typically used for fishmeal production.</p>
<p>In the previous simulations we had only one fishing gear and it
targeted all the species in the community. This gear had a knife-edge
selectivity that only selected species larger than 1 kg. We can see that
when we look at the gear parameters</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gear_params.html">gear_params</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                gear species   sel_func knife_edge_size</span></span>
<span><span class="co">## 1, knife_edge_gear  knife_edge_gear       1 knife_edge            1000</span></span>
<span><span class="co">## 2, knife_edge_gear  knife_edge_gear       2 knife_edge            1000</span></span>
<span><span class="co">## 3, knife_edge_gear  knife_edge_gear       3 knife_edge            1000</span></span>
<span><span class="co">## 4, knife_edge_gear  knife_edge_gear       4 knife_edge            1000</span></span>
<span><span class="co">## 5, knife_edge_gear  knife_edge_gear       5 knife_edge            1000</span></span>
<span><span class="co">## 6, knife_edge_gear  knife_edge_gear       6 knife_edge            1000</span></span>
<span><span class="co">## 7, knife_edge_gear  knife_edge_gear       7 knife_edge            1000</span></span>
<span><span class="co">## 8, knife_edge_gear  knife_edge_gear       8 knife_edge            1000</span></span>
<span><span class="co">## 9, knife_edge_gear  knife_edge_gear       9 knife_edge            1000</span></span>
<span><span class="co">## 10, knife_edge_gear knife_edge_gear      10 knife_edge            1000</span></span>
<span><span class="co">##                     catchability</span></span>
<span><span class="co">## 1, knife_edge_gear             1</span></span>
<span><span class="co">## 2, knife_edge_gear             1</span></span>
<span><span class="co">## 3, knife_edge_gear             1</span></span>
<span><span class="co">## 4, knife_edge_gear             1</span></span>
<span><span class="co">## 5, knife_edge_gear             1</span></span>
<span><span class="co">## 6, knife_edge_gear             1</span></span>
<span><span class="co">## 7, knife_edge_gear             1</span></span>
<span><span class="co">## 8, knife_edge_gear             1</span></span>
<span><span class="co">## 9, knife_edge_gear             1</span></span>
<span><span class="co">## 10, knife_edge_gear            1</span></span></code></pre>
<p>We will expand the model to include multiple fishing gears. This
requires us to look more closely at how fishing gears are handled in
<code>mizer</code>. In <code>mizer</code> it is possible for a fishing
gear to catch only a subset of the species in the model. This is useful
because when running a simulation with <code><a href="../reference/project.html">project()</a></code> you can
specify the effort per gear and so you can turn gears on or off as you
want. Each gear has a selectivity curve for each species.</p>
<p>We will set up the model to include two fishing gears: an
<code>industrial</code> gear that only catches species with a maximum
size less than or equal to 500g, and a second gear, <code>other</code>,
that catches everything else. The position of the knife-edge for both
gears will occur at 0.05 x the maximum size i.e. the selectivity
parameters will be different for each species and will depend on the
maximum size.</p>
<p>For this we will need to change the <code>gear_params</code> data
frame. If we want to keep the original model, we should first make a
copy before making modifications.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params_multi_gear</span> <span class="op">&lt;-</span> <span class="va">params</span></span></code></pre></div>
<p>To start with we need to know what the maximum sizes of the species
in the model are so we can determine the knife-edge positions for each
species. These are stored in the <code>w_max</code> column of the
<code>species_params</code> data frame inside the <code>params</code>
object. We can then use these maximum sizes to set a vector of knife
edge sizes that are 0.05 times the maximum size:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gear_params.html">gear_params</a></span><span class="op">(</span><span class="va">params_multi_gear</span><span class="op">)</span><span class="op">$</span><span class="va">knife_edge_size</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/species_params.html">species_params</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">$</span><span class="va">w_max</span> <span class="op">*</span> <span class="fl">0.05</span></span></code></pre></div>
<p>Now we want to assign each species to either the <em>industrial</em>
or <em>other</em> gear.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">no_sp</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">gear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Industrial"</span>, <span class="va">no_sp</span><span class="op">)</span></span>
<span><span class="va">gear</span><span class="op">[</span><span class="fu"><a href="../reference/species_params.html">species_params</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">$</span><span class="va">w_max</span> <span class="op">&gt;</span> <span class="fl">500</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Other"</span></span>
<span><span class="fu"><a href="../reference/gear_params.html">gear_params</a></span><span class="op">(</span><span class="va">params_multi_gear</span><span class="op">)</span><span class="op">$</span><span class="va">gear</span> <span class="op">&lt;-</span> <span class="va">gear</span></span></code></pre></div>
<p>To check what has just happened let us look at the new gear parameter
data frame:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gear_params.html">gear_params</a></span><span class="op">(</span><span class="va">params_multi_gear</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                     gear species   sel_func knife_edge_size catchability</span></span>
<span><span class="co">## 1, Industrial Industrial       1 knife_edge       0.4456255            1</span></span>
<span><span class="co">## 2, Industrial Industrial       2 knife_edge       1.2559432            1</span></span>
<span><span class="co">## 3, Industrial Industrial       3 knife_edge       3.5397289            1</span></span>
<span><span class="co">## 4, Industrial Industrial       4 knife_edge       9.9763116            1</span></span>
<span><span class="co">## 5, Other           Other       5 knife_edge      28.1170663            1</span></span>
<span><span class="co">## 6, Other           Other       6 knife_edge      79.2446596            1</span></span>
<span><span class="co">## 7, Other           Other       7 knife_edge     223.3417961            1</span></span>
<span><span class="co">## 8, Other           Other       8 knife_edge     629.4627059            1</span></span>
<span><span class="co">## 9, Other           Other       9 knife_edge    1774.0669462            1</span></span>
<span><span class="co">## 10, Other          Other      10 knife_edge    5000.0000000            1</span></span></code></pre>
<p>Having created our <code>MizerParams</code> object with multiple
gears, we can now turn our attention to running a projection with
multiple gears. In our previous examples of calling
<code><a href="../reference/project.html">project()</a></code> we have specified the fishing effort with the
<code>effort</code> argument using a single value. This fixes the
fishing effort for all gears in the model, for all time steps. We can do
this with our multi-gear parameter object:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_multi_gear</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">params_multi_gear</span>, t_max <span class="op">=</span> <span class="fl">75</span>, effort <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p>By plotting this you can see that the fishing mortality for each
species now has a different selectivity pattern, and that the position
of the selectivity knife-edge is given by the maximum size of the
species.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_multi_gear</span><span class="op">)</span></span></code></pre></div>
<p><img src="trait_model_files/figure-html/plot_multi_gear_trait_single_effort-1.png" alt="Summary plot of the trait-based model with multiple gears and a single effort." width="700"></p>
<p>For the industrial fishery we said that we only wanted species with a
maximum size of 500 g or less to be fished. There are several ways of
specifying the <code>effort</code> argument for <code><a href="../reference/project.html">project()</a></code> .
Above we specified a single value that was used for all gears, for all
time steps. It is also possible to specify a separate effort for each
gear that will be used for all time steps. To do this we pass in effort
as a named vector. Here we set the effort for the <em>Industrial</em>
gear to 0.75, and the effort of the <em>Other</em> gear to 0
(effectively turning it off).</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_multi_gear</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">params_multi_gear</span>, t_max <span class="op">=</span> <span class="fl">75</span>,</span>
<span>    effort <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Industrial <span class="op">=</span> <span class="fl">0.75</span>, Other <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now you can see that the <em>Industrial</em> gear has been operating
and that fishing mortality for species larger than 500 g is 0.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_multi_gear</span><span class="op">)</span></span></code></pre></div>
<p><img src="trait_model_files/figure-html/plot_multi_gear_trait-1.png" alt="Summary plot of the trait-based model with only the Industrial gear active." width="700"></p>
</div>
<div class="section level2">
<h2 id="the-impact-of-industrial-fishing">The impact of industrial fishing<a class="anchor" aria-label="anchor" href="#the-impact-of-industrial-fishing"></a>
</h2>
<p>In the previous section we set up and ran a model in which an
industrial fishery was operating that only selected smaller species. We
can now answer the question: what is the impact of such a fishery? We
can again compare abundances of the fished
(<code>sim_industrial1</code>) and unfished
(<code>sim_industrial0</code>) cases:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_industrial0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">params_multi_gear</span>, t_max <span class="op">=</span> <span class="fl">75</span>, effort <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">sim_industrial1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">params_multi_gear</span>, t_max <span class="op">=</span> <span class="fl">75</span>,</span>
<span>    effort <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Industrial <span class="op">=</span> <span class="fl">0.75</span>, Other <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">total_abund0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="../reference/finalN.html">finalN</a></span><span class="op">(</span><span class="va">sim_industrial0</span><span class="op">)</span>, <span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span></span>
<span><span class="va">total_abund1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="../reference/finalN.html">finalN</a></span><span class="op">(</span><span class="va">sim_industrial1</span><span class="op">)</span>, <span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span></span>
<span><span class="va">relative_abundance</span> <span class="op">&lt;-</span> <span class="va">total_abund1</span> <span class="op">/</span> <span class="va">total_abund0</span></span></code></pre></div>
<p>And plot the relative abundances:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="../reference/w.html">w</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">relative_abundance</span>, log <span class="op">=</span> <span class="st">"xy"</span>, type <span class="op">=</span> <span class="st">"n"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Size [g]"</span>, ylab <span class="op">=</span> <span class="st">"Relative abundance"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="../reference/w.html">w</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">relative_abundance</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="../reference/w.html">w</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="../reference/w.html">w</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="trait_model_files/figure-html/plot_relative_comm_abund_industrial-1.png" alt="Relative abundances from the unfished (dashed line) and fished (solid line)" width="700"></p>
<p>This shows another trophic cascade, although this time one driven by
fishing the species at the midrange part of the spectrum, not the
largest individuals as before. This trophic cascade acts in both
directions. The cascade upwards is driven by the lack of food for
predators leading to smaller realised maximum sizes. The cascade
downwards has the same mechanism as fishing on large fish, a combination
of predation mortality and food limitation.</p>
<p>The next section explains how to setup the more general <a href="multispecies_model.html">multispecies model.</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.york.ac.uk/maths/staff/gustav-delius/" class="external-link">Gustav Delius</a>, Finlay Scott, <a href="http://www.utas.edu.au/profiles/staff/imas/julia-blanchard" class="external-link">Julia Blanchard</a>, <a href="https://ken.haste.dk/" class="external-link">Ken Andersen</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
