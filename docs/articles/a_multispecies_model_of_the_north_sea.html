<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Multi-Species Model of the North Sea • mizer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="A Multi-Species Model of the North Sea">
<meta property="og:description" content="mizer">
<meta property="og:image" content="https://sizespectrum.org/mizer/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mizer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/mizer.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Tutorials</li>
    <li>
      <a href="../articles/single_species_size-spectrum_dynamics.html">Single-species size-spectrum dynamics</a>
    </li>
    <li>
      <a href="../articles/model_description.html">The General Mizer Size-spectrum Model</a>
    </li>
    <li>
      <a href="../articles/community_model.html">The Community Model</a>
    </li>
    <li>
      <a href="../articles/trait_model.html">The Trait-Based Model</a>
    </li>
    <li>
      <a href="../articles/multispecies_model.html">The Multi Species Model</a>
    </li>
    <li>
      <a href="../articles/running_a_simulation.html">Running a Simulation</a>
    </li>
    <li>
      <a href="../articles/exploring_the_simulation_results.html">Exploring the Simulation Results</a>
    </li>
    <li>
      <a href="../articles/a_multispecies_model_of_the_north_sea.html">A Multi-Species Model of the North Sea</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Using ggplot2 and plotly with mizer</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Publications</li>
    <li>
      <a href="../articles/publications.html">Publications</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">For developers</li>
    <li>
      <a href="../articles/developer_vignette.html">Developer Guide</a>
    </li>
    <li>
      <a href="../articles/working_with_git.html">Working with git and GitHub</a>
    </li>
    <li>
      <a href="../articles/developer_FAQ.html">Developer FAQ</a>
    </li>
    <li>
      <a href="../articles/editing_website.html">Editing the Mizer Website</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://blog.mizer.sizespectrum.org">Blog</a>
</li>
<li>
  <a href="https://twitter.com/mizer_model">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/sizespectrum/mizer/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="a_multispecies_model_of_the_north_sea_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A Multi-Species Model of the North Sea</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sizespectrum/mizer/blob/master/vignettes/a_multispecies_model_of_the_north_sea.Rmd"><code>vignettes/a_multispecies_model_of_the_north_sea.Rmd</code></a></small>
      <div class="hidden name"><code>a_multispecies_model_of_the_north_sea.Rmd</code></div>

    </div>

    
    
<p>In this section we try to pull everything together with an extended example of a multispecies model for the North Sea. First we will set up the model, project it through time using historical levels of fishing effort, and then examine the results. We then run two different future projection scenarios.</p>
<div id="setting-up-the-north-sea-model" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-up-the-north-sea-model" class="anchor"></a>Setting up the North Sea model</h2>
<p>The first job is to set up the <code>MizerParams</code> object for the North Sea model. In the previous multispecies examples we have already been using the life-history parameters and the interaction matrix for the North Sea model. We will use them again here but will make some changes. In particular we set up the fishing gears differently.</p>
<p>The species in the model are: Sprat, Sandeel, N.pout, Herring, Dab, Whiting, Sole, Gurnard, Plaice, Haddock, Cod, Saithe, which account for about 90% of the total biomass of all species sampled by research trawl surveys in the North Sea. The <code>NS_species_params</code> object that comes as an example with the mizer package is a data.frame with columns for <code>species</code>, <code>w_inf</code>, <code>w_mat</code>, <code>beta</code>, <code>sigma</code>, <code>k_vb</code> and <code>R_max</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NS_species_params</span></code></pre></div>
<pre><code>##    species   w_inf w_mat   beta sigma  k_vb    R_max
## 1    Sprat    33.0    13  51076   0.8 0.681 7.38e+11
## 2  Sandeel    36.0     4 398849   1.9 1.000 4.10e+11
## 3   N.pout   100.0    23     22   1.5 0.849 1.05e+13
## 4  Herring   334.0    99 280540   3.2 0.606 1.11e+12
## 5      Dab   324.0    21    191   1.9 0.536 1.12e+10
## 6  Whiting  1192.0    75     22   1.5 0.323 5.48e+11
## 7     Sole   866.0    78    381   1.9 0.284 3.87e+10
## 8  Gurnard   668.0    39    283   1.8 0.266 1.65e+12
## 9   Plaice  2976.0   105    113   1.6 0.122 4.08e+14
## 10 Haddock  4316.5   165    558   2.1 0.271 1.84e+12
## 11     Cod 39851.3  1606     66   1.3 0.216 8.26e+09
## 12  Saithe 39658.6  1076     40   1.1 0.175 1.12e+11</code></pre>
<p>We have seen before that only having these columns in the species data.frame is sufficient to make a <code>MizerParams</code> object. Any missing columns will be filled with default values by the <code>MizerParams</code> constructor. For example, the data.frame does not include columns for <code>h</code> or <code>gamma</code>. This means that they will be estimated using the <code>k_vb</code> column.</p>
<p>We will use the default density dependence in the reproduction rate, which is the Beverton-Holt shape. This requires a column <code>R_max</code> in the species data.frame which contains the maximum reproduction rate for each species. This column is already in the <code>NS_species_params</code> data.frame. The values were found through a calibration process which is not covered here but will be described in a separate tutorial.</p>
<p>At the moment we are not providing any information on the selectivity of the gears for the species. By default, the selectivity function is a knife-edge which only takes a single argument, <code>knife_edge_size</code>. In this model we want the selectivity pattern to be a sigmoid shape which more accurately reflects the selectivity pattern of trawlers in the North Sea. The sigmoid selectivity function is expressed in terms of length rather than weight and uses the parameters <code>l25</code> and <code>l50</code>, which are the lengths at which 25% and 50% of the stock is selected. The length based sigmoid selectivity looks like:</p>
<p><span class="math display">\[\begin{equation}
%     {#eq:trawl_sel}
    S_l = \frac{1}{1 + \exp(S1 - S2\ l)}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(l\)</span> is the length of an individual, <span class="math inline">\(S_l\)</span> is the selectivity at length, <span class="math inline">\(S2 = \log(3) / (l50 - l25)\)</span> and <span class="math inline">\(S1 = l50 \cdot S2\)</span>.</p>
<p>This selectivity function is included in mizer as <code><a href="../reference/sigmoid_length.html">sigmoid_length()</a></code>. You can see the help page for more details. As the mizer model is weight based, and this selectivity function is length based, it uses the length-weight parameters <code>a</code> and <code>b</code> to convert between length and weight using the standard relation <span class="math inline">\(w = a l^b\)</span>. These species parameters need to be added as columns to the <code>NS_species_params</code> data frame.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NS_species_params</span><span class="op">$</span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.007</span>, <span class="fl">0.001</span>, <span class="fl">0.009</span>, <span class="fl">0.002</span>, <span class="fl">0.010</span>, <span class="fl">0.006</span>, <span class="fl">0.008</span>, <span class="fl">0.004</span>,
                      <span class="fl">0.007</span>, <span class="fl">0.005</span>, <span class="fl">0.005</span>, <span class="fl">0.007</span><span class="op">)</span>
<span class="va">NS_species_params</span><span class="op">$</span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3.014</span>, <span class="fl">3.320</span>, <span class="fl">2.941</span>, <span class="fl">3.429</span>, <span class="fl">2.986</span>, <span class="fl">3.080</span>, <span class="fl">3.019</span>, <span class="fl">3.198</span>,
                      <span class="fl">3.101</span>, <span class="fl">3.160</span>, <span class="fl">3.173</span>, <span class="fl">3.075</span><span class="op">)</span></code></pre></div>
<p><code><a href="../reference/sigmoid_length.html">sigmoid_length()</a></code> has the arguments <code>l25</code> and <code>l50</code>. As explained in <a href="multispecies_model.html#sec:fishing_gear">the section on fishing gears and selectivity</a>, the arguments of the selectivity function need to be in the gear parameter data frame. We also need a column specifying the name of the selectivity function we wish to use. Note it would probably be easier to put this data into a *.csv file and then read it in rather than type it in by hand like we do here:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gear_params</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>species <span class="op">=</span> <span class="va">NS_species_params</span><span class="op">$</span><span class="va">species</span>,
               gear <span class="op">=</span> <span class="va">NS_species_params</span><span class="op">$</span><span class="va">species</span>,
               sel_func <span class="op">=</span> <span class="st">"sigmoid_length"</span>,
               l25 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7.6</span>, <span class="fl">9.8</span>, <span class="fl">8.7</span>, <span class="fl">10.1</span>, <span class="fl">11.5</span>, <span class="fl">19.8</span>, <span class="fl">16.4</span>, <span class="fl">19.8</span>, <span class="fl">11.5</span>,
                        <span class="fl">19.1</span>, <span class="fl">13.2</span>, <span class="fl">35.3</span><span class="op">)</span>,
               l50 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8.1</span>, <span class="fl">11.8</span>, <span class="fl">12.2</span>, <span class="fl">20.8</span>, <span class="fl">17.0</span>, <span class="fl">29.0</span>, <span class="fl">25.8</span>, <span class="fl">29.0</span>, <span class="fl">17.0</span>,
                       <span class="fl">24.3</span>, <span class="fl">22.9</span>, <span class="fl">43.6</span><span class="op">)</span><span class="op">)</span>
<span class="va">gear_params</span></code></pre></div>
<pre><code>##    species    gear       sel_func  l25  l50
## 1    Sprat   Sprat sigmoid_length  7.6  8.1
## 2  Sandeel Sandeel sigmoid_length  9.8 11.8
## 3   N.pout  N.pout sigmoid_length  8.7 12.2
## 4  Herring Herring sigmoid_length 10.1 20.8
## 5      Dab     Dab sigmoid_length 11.5 17.0
## 6  Whiting Whiting sigmoid_length 19.8 29.0
## 7     Sole    Sole sigmoid_length 16.4 25.8
## 8  Gurnard Gurnard sigmoid_length 19.8 29.0
## 9   Plaice  Plaice sigmoid_length 11.5 17.0
## 10 Haddock Haddock sigmoid_length 19.1 24.3
## 11     Cod     Cod sigmoid_length 13.2 22.9
## 12  Saithe  Saithe sigmoid_length 35.3 43.6</code></pre>
<p>Note that we have set up a <code>gear</code> column so that each species will be caught by a separate gear named after the species.</p>
<p>In this model we are interested in projecting forward using historical fishing mortalities. The historical fishing mortality from 1967 to 2010 for each species is stored in the csv file <code>NS_f_history.csv</code> included in the package. As before, we can use <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> to read in the data. This reads the data in as a <code>data.frame</code>. We want this to be a <code>matrix</code> so we use the <code>as()</code> function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f_location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"doc/NS_f_history.csv"</span>, package <span class="op">=</span> <span class="st">"mizer"</span><span class="op">)</span>
<span class="va">f_history</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="va">f_location</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, <span class="st">"matrix"</span><span class="op">)</span></code></pre></div>
<p>We can take a look at the first years of the data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">f_history</span><span class="op">)</span></code></pre></div>
<pre><code>##      Sprat Sandeel N.pout   Herring        Dab   Whiting      Sole Gurnard
## 1967     0       0      0 1.0360279 0.09417655 0.8294528 0.6502019       0
## 1968     0       0      0 1.7344576 0.07376065 0.8008995 0.7831250       0
## 1969     0       0      0 1.4345001 0.07573638 1.3168280 0.8744095       0
## 1970     0       0      0 1.4342405 0.10537236 1.3473505 0.6389915       0
## 1971     0       0      0 1.8234973 0.08385884 0.9741884 0.8167561       0
## 1972     0       0      0 0.9033768 0.09044461 1.3148588 0.7382834       0
##         Plaice   Haddock       Cod    Saithe
## 1967 0.4708827 0.7428694 0.6677456 0.4725102
## 1968 0.3688033 0.7084553 0.6994389 0.4270201
## 1969 0.3786819 1.3302821 0.6917888 0.3844648
## 1970 0.5268618 1.3670695 0.7070891 0.5987086
## 1971 0.4192942 0.9173131 0.7737543 0.4827822
## 1972 0.4522231 1.3279087 0.8393267 0.5796321</code></pre>
<p>Fishing mortality is calculated as the product of selectivity, catchability and fishing effort. The values in <code>f_history</code> are absolute levels of fishing mortality. We have seen that the fishing mortality in the <code>mizer</code> simulations is driven by the fishing effort argument passed to the <code><a href="../reference/project.html">project()</a></code> function. Therefore if we want to project forward with historical fishing levels, we need to provide <code><a href="../reference/project.html">project()</a></code> with effort values that will result in these historical fishing mortality levels.</p>
<p>One of the model parameters that we have not really considered so far is <code>catchability</code>. Catchability is a scalar parameter used to modify the fishing mortality at size given the selectivity at size and effort of the fishing gear. By default catchability has a value of 1, meaning that an effort of 1 results in a fishing mortality of 1 for a fully selected species. When considering the historical fishing mortality, one option is therefore to leave catchability at 1 for each species and then use the <code>f_history</code> matrix as the fishing effort. However, an alternative method is to use the effort relative to a chosen reference year. This can make the effort levels used in the model more meaningful. Here we use the year 1990 as the reference year. If we set the catchability of each species to be the same as the fishing mortality in 1990 then an effort of 1 in 1990 will result in the fishing mortality being what it was in 1990. The effort in the other years will be relative to the effort in 1990.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gear_params</span><span class="op">$</span><span class="va">catchability</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">f_history</span><span class="op">[</span><span class="st">"1990"</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<p>Considering the other model parameters, we will use default values for all of the other parameters apart from <code>kappa</code>, the carrying capacity of the resource spectrum (see <a href="model_description.html#resource-density">see the section on resource density</a>). This was estimated along with the values <code>R_max</code> as part of the calibration process.</p>
<p>We now have all the information we need to create the <code>MizerParams</code> object using the species parameters data.frame.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/newMultispeciesParams.html">newMultispeciesParams</a></span><span class="op">(</span><span class="va">NS_species_params</span>, 
                                interaction <span class="op">=</span> <span class="va">inter</span>, 
                                kappa <span class="op">=</span> <span class="fl">9.27e10</span>,
                                gear_params <span class="op">=</span> <span class="va">gear_params</span><span class="op">)</span></code></pre></div>
<pre><code>## Note: No h provided for some species, so using f0 and k_vb to calculate it.</code></pre>
<pre><code>## Note: Because you have n != p, the default value is not very good.</code></pre>
<pre><code>## Note: No ks column so calculating from critical feeding level.</code></pre>
<pre><code>## Note: Using z0 = z0pre * w_inf ^ z0exp for missing z0 values.</code></pre>
<pre><code>## Note: Using f0, h, lambda, kappa and the predation kernel to calculate gamma.</code></pre>
</div>
<div id="setting-up-and-running-the-simulation" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-up-and-running-the-simulation" class="anchor"></a>Setting up and running the simulation</h2>
<p>As we set our catchability to be the level of fishing mortality in 1990, before we can run the projection we need to rescale the effort matrix to get a matrix of efforts relative to 1990. To do this we want to rescale the <code>f_history</code> object to 1990 so that the relative fishing effort in 1990 = 1. This is done using R function <code><a href="https://rdrr.io/r/base/sweep.html">sweep()</a></code>. We then check a few rows of the effort matrix to check this has happened:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">relative_effort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html">sweep</a></span><span class="op">(</span><span class="va">f_history</span>,<span class="fl">2</span>,<span class="va">f_history</span><span class="op">[</span><span class="st">"1990"</span>,<span class="op">]</span>,<span class="st">"/"</span><span class="op">)</span>
<span class="va">relative_effort</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fl">1988</span><span class="op">:</span><span class="fl">1992</span><span class="op">)</span>,<span class="op">]</span></code></pre></div>
<pre><code>##          Sprat   Sandeel    N.pout  Herring      Dab   Whiting      Sole
## 1988 0.8953804 1.2633229 0.8953804 1.214900 1.176678 0.9972560 1.2786517
## 1989 1.1046196 1.2931034 1.1046196 1.232790 1.074205 0.8797926 0.9910112
## 1990 1.0000000 1.0000000 1.0000000 1.000000 1.000000 1.0000000 1.0000000
## 1991 1.1902174 0.8814002 1.1902174 1.108016 1.143110 0.8096927 1.0044944
## 1992 1.2500000 0.8500522 1.2500000 1.316576 1.113074 0.7718676 0.9505618
##        Gurnard   Plaice   Haddock      Cod    Saithe
## 1988 0.0000000 1.176678 0.9946140 1.045964 1.0330579
## 1989 0.0000000 1.074205 0.8545781 1.060538 1.1223140
## 1990 1.0000000 1.000000 1.0000000 1.000000 1.0000000
## 1991 0.8096927 1.143110 0.7971275 1.001121 0.9619835
## 1992 0.7718676 1.113074 0.8797127 0.970852 1.0528926</code></pre>
<p>We could just project forward with these relative efforts. However, the population dynamics in the early years will be strongly determined by the initial population abundances (known as the transient behaviour - essentially the initial behaviour before the long term dynamics are reached). As this is ecology, we don’t know what the initial abundance are. One way around this is to project forward at a constant fishing mortality equal to the mortality in the first historical year until equilibrium is reached. We then use this steady state as the initial state for the simulation. This approach reduces the impact of transient dynamics.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/projectToSteady.html">projectToSteady</a></span><span class="op">(</span><span class="va">params</span>, effort <span class="op">=</span> <span class="va">relative_effort</span><span class="op">[</span><span class="st">"1967"</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## Convergence was achieved in 24 years.</code></pre>
<p>We now have our parameter object and out matrix of efforts relative to 1990. We use this effort matrix as the <code>effort</code> argument to the <code><a href="../reference/project.html">project()</a></code> function. We use <code>dt</code> = 0.25 (the simulation will run faster than with the default value of 0.1, but tests show that the results are still stable) and save the results every year.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">params</span>, effort <span class="op">=</span> <span class="va">relative_effort</span>, dt <span class="op">=</span> <span class="fl">0.25</span>, t_save <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>Plotting the results, we can see how the biomasses of the stocks change over time.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotBiomass.html">plotBiomass</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></code></pre></div>
<p><img src="a_multispecies_model_of_the_north_sea_files/figure-html/plot_ns_biomass-1.png" width="700"></p>
<p>To explore the state of the community it is useful to calculate indicators of the unexploited community. Therefore we also project forward to the steady state with 0 fishing effort.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/projectToSteady.html">projectToSteady</a></span><span class="op">(</span><span class="va">params</span>, effort <span class="op">=</span> <span class="fl">0</span>, return_sim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Convergence was achieved in 42 years.</code></pre>
</div>
<div id="exploring-the-model-outputs" class="section level2">
<h2 class="hasAnchor">
<a href="#exploring-the-model-outputs" class="anchor"></a>Exploring the model outputs</h2>
<p>Here we look at some of the ways the results of the simulation can be explored. We calculate the community indicators <code>mean maximum weight</code>, <code>mean individual weight</code>, <code>community slope</code> and the <code>large fish indicator</code> (LFI) over the simulation period, and compare them to the unexploited values. We also compare the simulated values of the LFI to a community target based on achieving a high proportion of the unexploited value of the LFI of <span class="math inline">\(0.8 LFI_{F=0}\)</span>.</p>
<p>The indicators are calculated using the functions described in <a href="exploring_the_simulation_results.html#functions-for-calculating-indicators">the section about indicator functions</a>. Here we calculate the LFI and the other community indicators for the unexploited community. When calculating these indicators we only include demersal species and individuals in the size range 10 g to 100 kg, and the LFI is based on species larger than 40 cm. Each of these functions returns a time series. We are interested only in the equilibrium unexploited values so we just select the final time step.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">demersal_species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Dab"</span>, <span class="st">"Whiting"</span>, <span class="st">"Sole"</span>, <span class="st">"Gurnard"</span>, <span class="st">"Plaice"</span>,
                      <span class="st">"Haddock"</span>, <span class="st">"Cod"</span>, <span class="st">"Saithe"</span><span class="op">)</span>
<span class="va">final</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/idxFinalT.html">idxFinalT</a></span><span class="op">(</span><span class="va">sim0</span><span class="op">)</span>
<span class="va">lfi0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getProportionOfLargeFish.html">getProportionOfLargeFish</a></span><span class="op">(</span><span class="va">sim0</span>, species <span class="op">=</span> <span class="va">demersal_species</span>,
                                 min_w <span class="op">=</span> <span class="fl">10</span>, max_w <span class="op">=</span> <span class="fl">100e3</span>, 
                                 threshold_l <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">[[</span><span class="va">final</span><span class="op">]</span><span class="op">]</span>
<span class="va">mw0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getMeanWeight.html">getMeanWeight</a></span><span class="op">(</span><span class="va">sim0</span>, species <span class="op">=</span> <span class="va">demersal_species</span>,
                     min_w <span class="op">=</span> <span class="fl">10</span>,max_w <span class="op">=</span> <span class="fl">100e3</span><span class="op">)</span><span class="op">[[</span><span class="va">final</span><span class="op">]</span><span class="op">]</span>
<span class="va">mmw0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getMeanMaxWeight.html">getMeanMaxWeight</a></span><span class="op">(</span><span class="va">sim0</span>, species <span class="op">=</span> <span class="va">demersal_species</span>,
                         min_w <span class="op">=</span> <span class="fl">10</span>, max_w <span class="op">=</span> <span class="fl">100e3</span><span class="op">)</span><span class="op">[</span><span class="va">final</span>, <span class="st">"mmw_biomass"</span><span class="op">]</span>
<span class="va">slope0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCommunitySlope.html">getCommunitySlope</a></span><span class="op">(</span><span class="va">sim0</span>, species <span class="op">=</span> <span class="va">demersal_species</span>,
                            min_w <span class="op">=</span> <span class="fl">10</span>, max_w <span class="op">=</span> <span class="fl">100e3</span><span class="op">)</span><span class="op">[</span><span class="va">final</span>, <span class="st">"slope"</span><span class="op">]</span></code></pre></div>
<p>We also calculate the time series of these indicators for the exploited community:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lfi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getProportionOfLargeFish.html">getProportionOfLargeFish</a></span><span class="op">(</span><span class="va">sim</span>, species <span class="op">=</span> <span class="va">demersal_species</span>,
                                min_w <span class="op">=</span> <span class="fl">10</span>, max_w <span class="op">=</span> <span class="fl">100e3</span>, 
                                threshold_l <span class="op">=</span> <span class="fl">40</span><span class="op">)</span>
<span class="va">mw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getMeanWeight.html">getMeanWeight</a></span><span class="op">(</span><span class="va">sim</span>, species <span class="op">=</span> <span class="va">demersal_species</span>,
                    min_w <span class="op">=</span> <span class="fl">10</span>, max_w <span class="op">=</span> <span class="fl">100e3</span><span class="op">)</span>
<span class="va">mmw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getMeanMaxWeight.html">getMeanMaxWeight</a></span><span class="op">(</span><span class="va">sim</span>, species <span class="op">=</span> <span class="va">demersal_species</span>, min_w <span class="op">=</span> <span class="fl">10</span>,
                        max_w <span class="op">=</span> <span class="fl">100e3</span><span class="op">)</span><span class="op">[</span>, <span class="st">"mmw_biomass"</span><span class="op">]</span>
<span class="va">slope</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCommunitySlope.html">getCommunitySlope</a></span><span class="op">(</span><span class="va">sim</span>, species <span class="op">=</span> <span class="va">demersal_species</span>, min_w <span class="op">=</span> <span class="fl">10</span>,
                           max_w <span class="op">=</span> <span class="fl">100e3</span><span class="op">)</span><span class="op">[</span>, <span class="st">"slope"</span><span class="op">]</span></code></pre></div>
<p>We can plot the exploited and unexploited indicators, along LFI reference level. Here we do it using <code>ggplot2</code> which uses data.frames. We make three data.frames (one for the time series, one for the unexploited levels and one for the reference level): Each data.frame is a data.frame of each of the measures, stacked on top of each other.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="va">years</span> <span class="op">&lt;-</span> <span class="fl">1967</span><span class="op">:</span><span class="fl">2010</span>
<span class="co"># Simulated data</span>
<span class="va">community_plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">years</span>, measure <span class="op">=</span> <span class="st">"LFI"</span>, data <span class="op">=</span> <span class="va">lfi</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">years</span>, measure <span class="op">=</span> <span class="st">"Mean Weight"</span>, data <span class="op">=</span> <span class="va">mw</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">years</span>, measure <span class="op">=</span> <span class="st">"Mean Max Weight"</span>, data <span class="op">=</span> <span class="va">mmw</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">years</span>, measure <span class="op">=</span> <span class="st">"Slope"</span>, data <span class="op">=</span> <span class="va">slope</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Unexploited data</span>
<span class="va">community_unfished_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">years</span>, measure <span class="op">=</span> <span class="st">"LFI"</span>, data <span class="op">=</span> <span class="va">lfi0</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">years</span>, measure <span class="op">=</span> <span class="st">"Mean Weight"</span>, data <span class="op">=</span> <span class="va">mw0</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">years</span>, measure <span class="op">=</span> <span class="st">"Mean Max Weight"</span>, data <span class="op">=</span> <span class="va">mmw0</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">years</span>, measure <span class="op">=</span> <span class="st">"Slope"</span>, data <span class="op">=</span> <span class="va">slope0</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Reference level</span>
<span class="va">community_reference_level</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">years</span>, measure <span class="op">=</span> <span class="st">"LFI"</span>, data <span class="op">=</span> <span class="va">lfi0</span> <span class="op">*</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="co"># Build up the plot</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">community_plot_data</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">measure</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">data</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>,
              data <span class="op">=</span> <span class="va">community_unfished_data</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>,y<span class="op">=</span><span class="va">data</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>,
              data <span class="op">=</span> <span class="va">community_reference_level</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="a_multispecies_model_of_the_north_sea_files/figure-html/plot_ns_indicators-1.png" alt="Historical (solid) and unexploited (dashed) and reference (dotted) community indicators for the North Sea multispecies model." width="700"><p class="caption">
Historical (solid) and unexploited (dashed) and reference (dotted) community indicators for the North Sea multispecies model.
</p>
</div>
<p>According to our simulations, historically the LFI in the North Sea has been below the reference level.</p>
</div>
<div id="future-projections" class="section level2">
<h2 class="hasAnchor">
<a href="#future-projections" class="anchor"></a>Future projections</h2>
<p>As well as investigating the historical simulations, we can run projections into the future. Here we run two projections to 2050 with different fishing scenarios.</p>
<ul>
<li>Continue fishing at 2010 levels (the status quo scenario).</li>
<li>From 2010 to 2015 linearly change the fishing mortality to approach <span class="math inline">\(F_{MSY}\)</span> and then continue at <span class="math inline">\(F_{MSY}\)</span> until 2050.</li>
</ul>
<p>Rather than looking at community indicators here, we will calculate the SSB of each species in the model and compare the projected levels to a biodiversity target based on the reference point <span class="math inline">\(0.1 SSB_{F=0}.\)</span></p>
<p>Before we can run the simulations, we need to set up arrays of future effort. We will continue to use effort relative to the level in 1990. Here we build on our existing array of relative effort to make an array for the first scenario. Note the use of the <code><a href="https://rdrr.io/r/base/t.html">t()</a></code> command to transpose the array. This is needed because R recycles by rows, so we need to build the array with the dimensions rotated to start with. We make an array of the future effort, and then bind it underneath the <code>relative_effort</code> array used in the previous section.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scenario1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="va">relative_effort</span><span class="op">[</span><span class="st">"2010"</span>, <span class="op">]</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">40</span><span class="op">)</span>,
    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">NULL</span>, year <span class="op">=</span> <span class="fl">2011</span><span class="op">:</span><span class="fl">2050</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">scenario1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">relative_effort</span>, <span class="va">scenario1</span><span class="op">)</span></code></pre></div>
<p>The relative effort array for the second scenario is more complicated to make and requires a little bit of R gymnastics (it might be easier for you to prepare this in a spreadsheet and read it in). For this one we need values of <span class="math inline">\(F_{MSY}\)</span>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fmsy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>Sprat <span class="op">=</span> <span class="fl">0.2</span>, Sandeel <span class="op">=</span> <span class="fl">0.2</span>, N.pout <span class="op">=</span> <span class="fl">0.2</span>, Herring <span class="op">=</span> <span class="fl">0.25</span>, Dab <span class="op">=</span> <span class="fl">0.2</span>,
    Whiting <span class="op">=</span> <span class="fl">0.2</span>, Sole <span class="op">=</span> <span class="fl">0.22</span>, Gurnard <span class="op">=</span> <span class="fl">0.2</span>, Plaice <span class="op">=</span> <span class="fl">0.25</span>, Haddock <span class="op">=</span> <span class="fl">0.3</span>,
    Cod <span class="op">=</span> <span class="fl">0.19</span>, Saithe <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>
<span class="va">scenario2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="va">fmsy</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">40</span><span class="op">)</span>, 
                     dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">NULL</span>, year <span class="op">=</span> <span class="fl">2011</span><span class="op">:</span><span class="fl">2050</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">scenario2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">relative_effort</span>, <span class="va">scenario2</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">sp</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">scenario2</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">scenario2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fl">2011</span><span class="op">:</span><span class="fl">2015</span><span class="op">)</span>, <span class="va">sp</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">scenario2</span><span class="op">[</span><span class="st">"2010"</span>, <span class="va">sp</span><span class="op">]</span> <span class="op">+</span>
        <span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">scenario2</span><span class="op">[</span><span class="st">"2015"</span>, <span class="va">sp</span><span class="op">]</span> <span class="op">-</span> <span class="va">scenario2</span><span class="op">[</span><span class="st">"2010"</span>, <span class="va">sp</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">5</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>We are now ready to project the two scenarios.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">params</span>, effort <span class="op">=</span> <span class="va">scenario1</span>, dt <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>
<span class="va">sim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">params</span>, effort <span class="op">=</span> <span class="va">scenario2</span>, dt <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></code></pre></div>
<p>We can now compare the projected SSB values in both scenarios to the biodiversity reference points. First we calculate the biodiversity reference points (from the final time step in the unexploited <code>sim0</code> simulation):</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ssb0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getSSB.html">getSSB</a></span><span class="op">(</span><span class="va">sim0</span><span class="op">)</span><span class="op">[</span><span class="va">final</span>, <span class="op">]</span></code></pre></div>
<p>Now we build a data.frame of the projected SSB for each species. We make use of the <code><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt()</a></code> function to transform arrays into data frames.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">years</span> <span class="op">&lt;-</span> <span class="fl">1967</span><span class="op">:</span><span class="fl">2050</span>
<span class="va">ssb1_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="../reference/getSSB.html">getSSB</a></span><span class="op">(</span><span class="va">sim1</span><span class="op">)</span><span class="op">)</span>
<span class="va">ssb2_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="../reference/getSSB.html">getSSB</a></span><span class="op">(</span><span class="va">sim2</span><span class="op">)</span><span class="op">)</span>
<span class="va">ssb_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">ssb1_df</span>, scenario <span class="op">=</span> <span class="st">"Status quo"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">ssb2_df</span>, scenario <span class="op">=</span> <span class="st">"Fmsy"</span><span class="op">)</span><span class="op">)</span>
<span class="va">ssb_unexploited_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>
    sp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">ssb0</span><span class="op">)</span>,
    time <span class="op">=</span> <span class="fl">1967</span><span class="op">:</span><span class="fl">2050</span><span class="op">)</span>,
    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">ssb0</span><span class="op">)</span>,
    scenario <span class="op">=</span> <span class="st">"Unexploited"</span><span class="op">)</span>
<span class="va">ssb_reference_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>
    sp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">ssb0</span><span class="op">)</span>,
    time <span class="op">=</span> <span class="fl">1967</span><span class="op">:</span><span class="fl">2050</span><span class="op">)</span>,
    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">ssb0</span> <span class="op">*</span> <span class="fl">0.1</span><span class="op">)</span>,
    scenario <span class="op">=</span> <span class="st">"Reference"</span><span class="op">)</span>
<span class="va">ssb_all_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">ssb_df</span>, <span class="va">ssb_unexploited_df</span>, <span class="va">ssb_reference_df</span><span class="op">)</span>
<span class="va">colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Status quo"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"Fmsy"</span> <span class="op">=</span> <span class="st">"yellow"</span>,
             <span class="st">"Unexploited"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"Reference"</span> <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">ssb_all_df</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">value</span>, colour <span class="op">=</span> <span class="va">scenario</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sp</span>, scales <span class="op">=</span> <span class="st">"free"</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">colours</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="a_multispecies_model_of_the_north_sea_files/figure-html/projected_ssb_ns-1.png" alt="Historical and projected SSB under two fishing scenarios. Status quo (red), Fmsy (yellow). Unexploited (blue) and reference levels (purple) are also shown." width="700"><p class="caption">
Historical and projected SSB under two fishing scenarios. Status quo (red), Fmsy (yellow). Unexploited (blue) and reference levels (purple) are also shown.
</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.york.ac.uk/maths/staff/gustav-delius/">Gustav Delius</a>, Finlay Scott, <a href="http://www.utas.edu.au/profiles/staff/imas/julia-blanchard">Julia Blanchard</a>, <a href="https://ken.haste.dk/">Ken Andersen</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '96e9641255d3fff35a4fd16d1a1bf70c',
    indexName: 'sizespectrum_mizer',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
