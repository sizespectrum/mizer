<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The predation kernel determines the distribution of prey sizes that a
predator feeds on. It is used in getEncounter() when calculating
the rate at which food is encountered and in getPredRate() when
calculating the rate at which a prey is predated upon. The predation kernel
can be a function of the predator/prey size ratio or it can be a function of
the predator size and the prey size separately. Both types can be set up with
this function."><title>Set predation kernel — setPredKernel • mizer</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Set predation kernel — setPredKernel"><meta property="og:description" content="The predation kernel determines the distribution of prey sizes that a
predator feeds on. It is used in getEncounter() when calculating
the rate at which food is encountered and in getPredRate() when
calculating the rate at which a prey is predated upon. The predation kernel
can be a function of the predator/prey size ratio or it can be a function of
the predator size and the prey size separately. Both types can be set up with
this function."><meta property="og:image" content="https://sizespectrum.org/mizer/reference/figures/logo.png"><meta property="og:image:alt" content="mizer: Multi-Species Size Spectrum Modelling in R"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@mizer_model"><meta name="twitter:site" content="@mizer_model"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mizer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.3.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/mizer.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/model_description.html">The General Mizer Size-spectrum Model</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Tutorials</h6>
    <a class="dropdown-item" href="../articles/single_species_size-spectrum_dynamics.html">Single-species size-spectrum dynamics</a>
    <a class="dropdown-item" href="../articles/community_model.html">The Community Model</a>
    <a class="dropdown-item" href="../articles/trait_model.html">The Trait-Based Model</a>
    <a class="dropdown-item" href="../articles/multispecies_model.html">The Multi Species Model</a>
    <a class="dropdown-item" href="../articles/running_a_simulation.html">Running a Simulation</a>
    <a class="dropdown-item" href="../articles/exploring_the_simulation_results.html">Exploring the Simulation Results</a>
    <a class="dropdown-item" href="../articles/a_multispecies_model_of_the_north_sea.html">A Multi-Species Model of the North Sea</a>
    <a class="dropdown-item" href="../articles/plotting.html">Using ggplot2 and plotly with mizer</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Publications</h6>
    <a class="dropdown-item" href="../articles/publications.html">Publications</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>For developers</h6>
    <a class="dropdown-item" href="../articles/developer_vignette.html">Developer Guide</a>
    <a class="dropdown-item" href="../articles/working_with_git.html">Working with git and GitHub</a>
    <a class="dropdown-item" href="../articles/developer_FAQ.html">Developer FAQ</a>
    <a class="dropdown-item" href="../articles/editing_website.html">Editing the Mizer Website</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://blog.mizer.sizespectrum.org">Blog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/mizer_model" aria-label="Twitter">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sizespectrum/mizer/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Set predation kernel</h1>
      <small class="dont-index">Source: <a href="https://github.com/sizespectrum/mizer/blob/HEAD/R/setPredKernel.R" class="external-link"><code>R/setPredKernel.R</code></a></small>
      <div class="d-none name"><code>setPredKernel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The predation kernel determines the distribution of prey sizes that a
predator feeds on. It is used in <code><a href="getEncounter.html">getEncounter()</a></code> when calculating
the rate at which food is encountered and in <code><a href="getPredRate.html">getPredRate()</a></code> when
calculating the rate at which a prey is predated upon. The predation kernel
can be a function of the predator/prey size ratio or it can be a function of
the predator size and the prey size separately. Both types can be set up with
this function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">setPredKernel</span><span class="op">(</span><span class="va">params</span>, pred_kernel <span class="op">=</span> <span class="cn">NULL</span>, reset <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">getPredKernel</span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pred_kernel</span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pred_kernel</span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>params</dt>
<dd><p>A MizerParams object</p></dd>


<dt>pred_kernel</dt>
<dd><p>Optional. An array (species x predator size x prey size)
that holds the predation coefficient of each predator at size on each prey
size. If not supplied, a default is set as described in section "Setting
predation kernel".</p></dd>


<dt>reset</dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
If set to TRUE, then the predation kernel will be reset to the
value calculated from the species parameters, even if it was previously
overwritten with a custom value. If set to FALSE (default) then a
recalculation from the species parameters will take place only if no custom
value has been set.</p></dd>


<dt>...</dt>
<dd><p>Unused</p></dd>


<dt>value</dt>
<dd><p>pred_kernel</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>setPredKernel()</code>: A MizerParams object with updated predation kernel.</p>


<p><code>getPredKernel()</code> or equivalently <code>pred_kernel()</code>: An array (predator
species x predator_size x prey_size)</p>
    </div>
    <div class="section level2">
    <h2 id="setting-predation-kernel">Setting predation kernel<a class="anchor" aria-label="anchor" href="#setting-predation-kernel"></a></h2>
    

<p><strong>Kernel dependent on predator to prey size ratio</strong></p>
<p>If the <code>pred_kernel</code> argument is not supplied, then this function sets a
predation kernel that depends only on the ratio of predator mass to prey
mass, not on the two masses independently. The shape of that kernel is then
determined by the <code>pred_kernel_type</code> column in species_params.</p>
<p>The default for <code>pred_kernel_type</code> is "lognormal". This will call the function
<code><a href="lognormal_pred_kernel.html">lognormal_pred_kernel()</a></code> to calculate the predation kernel.
An alternative pred_kernel type is "box", implemented by the function
<code><a href="box_pred_kernel.html">box_pred_kernel()</a></code>, and "power_law", implemented by the function
<code><a href="power_law_pred_kernel.html">power_law_pred_kernel()</a></code>. These functions require certain species
parameters in the species_params data frame. For the lognormal kernel these
are <code>beta</code> and <code>sigma</code>, for the box kernel they are <code>ppmr_min</code>
and <code>ppmr_max</code>. They are explained in the help pages for the kernel
functions. Except for <code>beta</code> and <code>sigma</code>, no defaults are set for
these parameters. If they are missing from the species_params data frame then
mizer will issue an error message.</p>
<p>You can use any other string for <code>pred_kernel_type</code>. If for example you
choose "my" then you need to define a function <code>my_pred_kernel</code> that you can
model on the existing functions like <code><a href="lognormal_pred_kernel.html">lognormal_pred_kernel()</a></code>.</p>
<p>When using a kernel that depends on the predator/prey size ratio only, mizer
does not need to store the entire three dimensional array in the MizerParams
object. Such an array can be very big when there is a large number of size
bins. Instead, mizer only needs to store two two-dimensional arrays that hold
Fourier transforms of the feeding kernel function that allow the encounter
rate and the predation rate to be calculated very efficiently. However, if
you need the full three-dimensional array you can calculate it with the
<code>getPredKernel()</code> function.</p>
<p><strong>Kernel dependent on both predator and prey size</strong></p>
<p>If you want to work with a feeding kernel that depends on predator mass and
prey mass independently, you can specify the full feeding kernel as a
three-dimensional array (predator species x predator size x prey size).</p>
<p>You should use this option only if a kernel dependent only on the
predator/prey mass ratio is not appropriate. Using a kernel dependent on
predator/prey mass ratio only allows mizer to use fast Fourier transform
methods to significantly reduce the running time of simulations.</p>
<p>The order of the predator species in <code>pred_kernel</code> should be the same
as the order in the species params dataframe in the <code>params</code> object. If you
supply a named array then the function will check the order and warn if it is
different.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other functions for setting parameters: 
<code><a href="gear_params.html">gear_params</a>()</code>,
<code><a href="resource_params.html">resource_params</a>()</code>,
<code><a href="setExtMort.html">setExtMort</a>()</code>,
<code><a href="setFishing.html">setFishing</a>()</code>,
<code><a href="setInitialValues.html">setInitialValues</a>()</code>,
<code><a href="setInteraction.html">setInteraction</a>()</code>,
<code><a href="setMaxIntakeRate.html">setMaxIntakeRate</a>()</code>,
<code><a href="setMetabolicRate.html">setMetabolicRate</a>()</code>,
<code><a href="setParams.html">setParams</a>()</code>,
<code><a href="setReproduction.html">setReproduction</a>()</code>,
<code><a href="setResource.html">setResource</a>()</code>,
<code><a href="setSearchVolume.html">setSearchVolume</a>()</code>,
<code><a href="species_params.html">species_params</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## Set up a MizerParams object</span></span></span>
<span class="r-in"><span><span class="va">params</span> <span class="op">&lt;-</span>  <span class="va">NS_params</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## If you change predation kernel parameters after setting up a model, </span></span></span>
<span class="r-in"><span><span class="co">#  this will be used to recalculate the kernel</span></span></span>
<span class="r-in"><span><span class="fu"><a href="species_params.html">species_params</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">[</span><span class="st">"Cod"</span>, <span class="st">"beta"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">200</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## You can change to a different predation kernel type</span></span></span>
<span class="r-in"><span><span class="fu"><a href="species_params.html">species_params</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">$</span><span class="va">ppmr_max</span> <span class="op">&lt;-</span> <span class="fl">4000</span></span></span>
<span class="r-in"><span><span class="fu"><a href="species_params.html">species_params</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">$</span><span class="va">ppmr_min</span> <span class="op">&lt;-</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="fu"><a href="species_params.html">species_params</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">$</span><span class="va">pred_kernel_type</span> <span class="op">&lt;-</span> <span class="st">"box"</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="w.html">w_full</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span>, <span class="fu">getPredKernel</span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">[</span><span class="st">"Cod"</span>, <span class="fl">100</span>, <span class="op">]</span>, type<span class="op">=</span><span class="st">"l"</span>, log<span class="op">=</span><span class="st">"x"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## If you need a kernel that depends also on prey size you need to define</span></span></span>
<span class="r-in"><span><span class="co"># it yourself.</span></span></span>
<span class="r-in"><span><span class="va">pred_kernel</span> <span class="op">&lt;-</span> <span class="fu">getPredKernel</span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred_kernel</span><span class="op">[</span><span class="st">"Herring"</span>, , <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">pred_kernel</span><span class="op">[</span><span class="st">"Herring"</span>, , <span class="op">]</span>, <span class="fl">2</span>, </span></span>
<span class="r-in"><span>                                    <span class="va">params</span><span class="op">@</span><span class="va">w_full</span>, <span class="st">"*"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">params</span><span class="op">&lt;-</span> <span class="fu">setPredKernel</span><span class="op">(</span><span class="va">params</span>, pred_kernel <span class="op">=</span> <span class="va">pred_kernel</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://www.york.ac.uk/maths/staff/gustav-delius/" class="external-link">Gustav Delius</a>, Finlay Scott, <a href="http://www.utas.edu.au/profiles/staff/imas/julia-blanchard" class="external-link">Julia Blanchard</a>, <a href="https://ken.haste.dk/" class="external-link">Ken Andersen</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer></div>

  

  

  </body></html>

