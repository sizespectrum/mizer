<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Running a Simulation • mizer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Running a Simulation">
<meta property="og:description" content="mizer">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mizer</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">2.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mizer.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/model_description.html">The General Mizer Size-spectrum Model</a>
    </li>
    <li>
      <a href="../articles/community_model.html">The Community Model</a>
    </li>
    <li>
      <a href="../articles/trait_model.html">The Trait-Based Model</a>
    </li>
    <li>
      <a href="../articles/multispecies_model.html">The Multi Species Model</a>
    </li>
    <li>
      <a href="../articles/running_a_simulation.html">Running a Simulation</a>
    </li>
    <li>
      <a href="../articles/exploring_the_simulation_results.html">Exploring the Simulation Results</a>
    </li>
    <li>
      <a href="../articles/a_multispecies_model_of_the_north_sea.html">A Multi-Species Model Of The North Sea</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Using ggplot2 and plotly with mizer</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">For developers</li>
    <li>
      <a href="../articles/developer_vignette.html">Developer Guide</a>
    </li>
    <li>
      <a href="../articles/working_with_git.html">Working with git and GitHub</a>
    </li>
    <li>
      <a href="../articles/developer_FAQ.html">Developer FAQ</a>
    </li>
    <li>
      <a href="../articles/editing_website.html">Editing the Mizer Website</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/publications.html">Publications</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sizespectrum/mizer/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Running a Simulation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sizespectrum/mizer/blob/master/vignettes/running_a_simulation.Rmd"><code>vignettes/running_a_simulation.Rmd</code></a></small>
      <div class="hidden name"><code>running_a_simulation.Rmd</code></div>

    </div>

    
    
<div id="sec:projection" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:projection" class="anchor"></a>Introduction</h2>
<p>In the <a href="community_model.html">community</a> and <a href="trait_model.html">trait-based</a> models, we used the <code><a href="../reference/project.html">project()</a></code> function to perform simple simulations where the fishing effort was held constant throughout the duration of the simulation. In the trait-based model example, we also looked at how the effort for different gears could be specified. In this section we take a detailed look at how the <code><a href="../reference/project.html">project()</a></code> function works and the different ways in which effort and time can be set up. This will allow us to run more general systems like the <a href="multispecies_model.html">multispecies model.</a></p>
<p>In <code>mizer</code>, simulations are performed using the <code><a href="../reference/project.html">project()</a></code> function. This function takes a <code>MizerParams</code> object and projects it forward through time, starting from an initial population abundance and with a pre-determined fishing effort pattern.</p>
<p>Running a projection with <code><a href="../reference/project.html">project()</a></code> requires various arguments:</p>
<ul>
<li><p>A <code>MizerParams</code> object - The model parameters (see previous section);</p></li>
<li><p>Fishing effort - The fishing effort of each gear through time;</p></li>
<li><p>Time arguments - Arguments to control the time of the simulation, including the simulation time step, the length of the simulation and how frequently the output is stored.</p></li>
<li><p>Initial population - The initial abundances of the stocks and the resource spectrum;</p></li>
</ul>
<p>The help page for <code><a href="../reference/project.html">project()</a></code> describes the arguments in more detail.</p>
<p>The <code>MizerParams</code> class was explored in the previous section. In this section we will look at the other arguments and use examples to perform some simple projections.</p>
</div>
<div id="sec:time_arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:time_arguments" class="anchor"></a>The time arguments</h2>
<p>There are four arguments that control time in the <code><a href="../reference/project.html">project()</a></code> function: <code>dt</code>, <code>t_max</code> and <code>t_save</code> and <code>t_start</code>. All of them have default values.</p>
<ul>
<li>
<code>t_max</code> determines the maximum time of the simulation (in years), i.e. how long the projection is run for. The default value for <code>t_max</code> is 100.</li>
<li>
<code>dt</code> is the time step used by the numerical solver in <code><a href="../reference/project.html">project()</a></code>. The smaller the value, the longer the model will take to run. Sometimes it is necessary to use a small value to avoid numerical instabilities. The default value is 0.1.</li>
<li>
<code>t_save</code> sets the interval (in years) at which <code><a href="../reference/project.html">project()</a></code> stores the state of the model in the resulting <code>MizerSim</code> object. For example, if <code>t_save</code> = 2, the state of the model is stored at t = 0, 2, 4… etc. <code>t_save</code> must be a multiple of <code>dt</code>. The default value of <code>t_save</code> is 1.</li>
<li>
<code>t_start</code> is the year in which the simulation starts. This is only needed if you want to label the simulation results by the actual year rather than by the number of years that have elapsed since the start of the simulation.</li>
</ul>
</div>
<div id="setting-the-fishing-effort" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-the-fishing-effort" class="anchor"></a>Setting the fishing effort</h2>
<p>The fishing effort argument describes the effort of the fishing gears in the model through time. We have already seen that information on the fishing gears and their selectivities and catchabilities is stored in the <code>MizerParams</code> object.</p>
<p>There are three ways of setting the fishing effort. Examples of all three can be seen in <a href="running_a_simulation.html#sec:projection_examples">the section on projection examples.</a></p>
<p>The simplest way is by passing the <code>effort</code> argument as a single number. This value is then used as the fishing effort by all of the gears at each time step of the projection, i.e. fishing effort is constant throughout the simulation and is the same for all gears. We have seen this method in the community and trait-based model sections above. The length of the simulation is determined by the <code>t_max</code> argument.</p>
<p>The second method for setting the fishing effort is to use a numeric vector that has the same length as the number of gears. The values in the vector are used as the fishing effort of each gear at each time step, i.e. again, the fishing effort is constant through time but now each gear can have a different constant effort. The effort vector must be named and the names must be the same as the gears in the <code>MizerParams</code> object. Again, the length of the simulation is determined by the <code>t_max</code> argument.</p>
<p>Finally, the most sophisticated way of setting the fishing effort is to use a two-dimensional array or matrix of values, set up as time step by gear. Each row of the array has the effort values of each fishing gear at a particular time time. The array must have dimension names. The names of the first dimension (the row names) are the times. The steps between the times can be greater than the <code>dt</code> argument but the times must be increasing. The names of the second dimension (the column names) must match the names of the gears in the <code>MizerParams</code> object used in the projection.</p>
<p>It is not necessary to supply a <code>t_max</code> argument when the effort is specified as an array because the maximum time of the simulation is taken from the dimension names. If a value for <code>t_max</code> is also supplied it is ignored.</p>
</div>
<div id="sec:setting_initial_abundances" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:setting_initial_abundances" class="anchor"></a>Setting the initial population abundance</h2>
<p>When running a simulation with the <code><a href="../reference/project.html">project()</a></code> function, the initial populations of the species and the resource spectrum need to be specified. Default values for the initial values are automatically set when creating a MizerParams object. However you can change these by assigning new values to <code><a href="../reference/initialN-set.html">initialN()</a></code> and <code><a href="../reference/initialNResource-set.html">initialNResource()</a></code>. <code><a href="../reference/initialN-set.html">initialN()</a></code> should be set to a matrix (with dimensions species x size) that contains the initial abundances of each species at size (the sizes must match those in the species size spectrum). <code>initialNResource</code> to a vector of the same length as the the length of the full spectrum.</p>
</div>
<div id="sec:projection_examples" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:projection_examples" class="anchor"></a>Projection examples</h2>
<p>In this section we’ll look at how to run simulations with the <code><a href="../reference/project.html">project()</a></code> function. The examples will focus on how fishing effort can be specified in different ways. The results of the simulations will not be explored in detail. We will leave that for <a href="exploring_the_simulation_results.html#">the section on exploring the simulation results.</a>.</p>

<p>Remember that the fishing mortality by size on a species is the product of the selectivity, the catchability and the effort of the gear that caught it. We have not specified any catchability values in the species parameter data.frame so the default value of 1 is used. The selectivity ranges between 0 and 1. This means that in these examples the fishing mortality of a fully selected species is given by the effort of the gear that catches it.</p>
<div id="projections-with-single-simple-constant-effort" class="section level3">
<h3 class="hasAnchor">
<a href="#projections-with-single-simple-constant-effort" class="anchor"></a>Projections with single, simple constant effort</h3>
<p>When we use a single value for the <code>effort</code> argument, the value is used as a constant effort for all the gears. This method can be particularly useful for quickly projecting forward without fishing (you just set the <code>effort</code> argument to 0).</p>
<p>We will use a MizerParams object with four gears similar to the one that we created in <a href="multispecies_model.html#sec:params_example">the section with examples of making a MizerParams objects</a> This example MizerParams object is called <code>NS_params</code> and is shipped with the mizer package. Let’s have a look at its summary:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">NS_params</span>)</pre></body></html></div>
<pre><code>## An object of class "MizerParams" 
## Consumer size spectrum:
##  minimum size:   0.001
##  maximum size:   39851.3
##  no. size bins:  100
## Resource size spectrum:
##  minimum size:   2.12182e-13
##  maximum size:   9.82091
##  no. size bins:  179 (226 size bins in total)
## Species details:
##    species   w_inf w_mat w_min  f0  k_vb   beta sigma
## 1    Sprat    33.0    13 0.001 0.6 0.681  51076   0.8
## 2  Sandeel    36.0     4 0.001 0.6 1.000 398849   1.9
## 3   N.pout   100.0    23 0.001 0.6 0.849     22   1.5
## 4  Herring   334.0    99 0.001 0.6 0.606 280540   3.2
## 5      Dab   324.0    21 0.001 0.6 0.536    191   1.9
## 6  Whiting  1192.0    75 0.001 0.6 0.323     22   1.5
## 7     Sole   866.0    78 0.001 0.6 0.284    381   1.9
## 8  Gurnard   668.0    39 0.001 0.6 0.266    283   1.8
## 9   Plaice  2976.0   105 0.001 0.6 0.122    113   1.6
## 10 Haddock  4316.5   165 0.001 0.6 0.271    558   2.1
## 11     Cod 39851.3  1606 0.001 0.6 0.216     66   1.3
## 12  Saithe 39658.6  1076 0.001 0.6 0.175     40   1.1
## Fishing gear details:
##  Gear            Target species
##   Industrial          Sprat Sandeel N.pout 
##   Pelagic         Herring 
##   Beam        Dab Sole Plaice 
##   Otter       Whiting Gurnard Haddock Cod Saithe</code></pre>
<p>As well as thinking about the <code>effort</code> argument we also need to consider the time parameters. We will project the populations forward until time equals 10 (<code>t_max</code> = 10), with a time step of 0.1 (<code>dt</code> = 0.1), saving the output every time step (<code>t_save</code> = 1). We use a constant effort value of 1.0.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span>(<span class="no">NS_params</span>, <span class="kw">effort</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">t_max</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">dt</span> <span class="kw">=</span> <span class="fl">0.1</span>, <span class="kw">t_save</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p>The resulting <code>sim</code> object is of class <code>MizerSim</code>. At this point we won’t explore how the results can be investigated in detail. However, we will use the basic summary plot that you have seen before:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">sim</span>)</pre></body></html></div>
<p><img src="running_a_simulation_files/figure-html/plot_basic_ms_sim-1.png" width="700"></p>
<p>The big difference between this multispecies model and the trait-based model can be seen in the range of predation mortality and feeding level values. With the trait-based model all the <em>species</em> had the same predation mortality and feeding level patterns. Here the species all have different patterns, driven by their differing life history characteristics and the heterogeneous interaction matrix.</p>
<p>You can also see in the above figure that each species has different fishing selectivity (see the fishing mortality panel). Remember that the default setting for the fishing gears is a knife-edge gear where the knife-edge is positioned at the species <code>w_mat</code> parameter.</p>
<p>The effort through time can be inspected with <code><a href="../reference/effort.html">effort()</a></code> (we use the <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> function to just show the first few lines).</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fu"><a href="../reference/effort.html">effort</a></span>(<span class="no">sim</span>))</pre></body></html></div>
<pre><code>##     gear
## time Industrial Pelagic Beam Otter
##    0          1       1    1     1
##    1          1       1    1     1
##    2          1       1    1     1
##    3          1       1    1     1
##    4          1       1    1     1
##    5          1       1    1     1</code></pre>
<p>The <code>effort</code> slot shows the effort by time and gear. In this example, we specified the <code>effort</code> argument as a single numeric of value 1. As you can see this results in the same effort being used for all gears for all time steps.</p>
<p>A <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> method is also available for objects of type <code>MizerSim</code>. This is essentially the same as the summary for <code>MizerParams</code> objects, but includes information on the simulation time parameters.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">sim</span>)</pre></body></html></div>
<p>If we decrease <code>t_save</code> but keep <code>t_max</code> the same then we can see that the time dimension of the <code>effort</code> array changes accordingly. This will also be true of the simulation results returned by <code><a href="../reference/N.html">N()</a></code> and <code><a href="../reference/N.html">NResource()</a></code>. Here we reduce <code>t_save</code> to 0.5, meaning that the effort and abundance information is stored at t = 1.0, 1.5, 2.0 etc.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span>(<span class="no">NS_params</span>, <span class="kw">effort</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">t_max</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">dt</span> <span class="kw">=</span> <span class="fl">0.1</span>, <span class="kw">t_save</span> <span class="kw">=</span> <span class="fl">0.5</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fu"><a href="../reference/effort.html">effort</a></span>(<span class="no">sim</span>))</pre></body></html></div>
<pre><code>##      gear
## time  Industrial Pelagic Beam Otter
##   0            1       1    1     1
##   0.5          1       1    1     1
##   1            1       1    1     1
##   1.5          1       1    1     1
##   2            1       1    1     1
##   2.5          1       1    1     1</code></pre>
</div>
<div id="sec:proj_diff_gears_constant_effort" class="section level3">
<h3 class="hasAnchor">
<a href="#sec:proj_diff_gears_constant_effort" class="anchor"></a>Setting constant effort for different gears</h3>
<p>As mentioned above, we can also set the effort values for each gear separately using a vector of effort values. This still keeps the efforts constant through time but it means that each gear can have a different constant effort.</p>
<p>We need to create a named vector of effort, where the names match the gears. For example, here we want to switch off the industrial gear (i.e. effort = 0), keep the pelagic gear effort at 1, set the effort of the beam trawl gears to 0.3 and the effort of the otter trawl gear to 0.7. We set the <code>effort</code> like this:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">effort</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">Industrial</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">Pelagic</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">Beam</span> <span class="kw">=</span> <span class="fl">0.3</span>, <span class="kw">Otter</span> <span class="kw">=</span> <span class="fl">0.7</span>)</pre></body></html></div>
<p>We then call <code><a href="../reference/project.html">project()</a></code> with this effort and inspect the resulting <code>effort</code> matrix (again we use the <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> function to just show the first few lines):</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span>(<span class="no">NS_params</span>, <span class="kw">effort</span> <span class="kw">=</span> <span class="no">effort</span>, <span class="kw">t_max</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">dt</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">t_save</span> <span class="kw">=</span> <span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fu"><a href="../reference/effort.html">effort</a></span>(<span class="no">sim</span>))</pre></body></html></div>
<pre><code>##     gear
## time Industrial Pelagic Beam Otter
##    0          0       1  0.3   0.7
##    1          0       1  0.3   0.7
##    2          0       1  0.3   0.7
##    3          0       1  0.3   0.7
##    4          0       1  0.3   0.7
##    5          0       1  0.3   0.7</code></pre>
<p>You can see that the effort for each gear is constant but each gear has the effort that was specified in the <code>effort</code> argument.</p>
<p>This impact of this can be seen plotting the fishing mortality. There is a dedicated plot, <code><a href="../reference/plotFMort.html">plotFMort()</a></code>, that shows the fishing mortality at size for each species at a particular time step (the default is the final time step). The fishing mortality on each of the species is determined by the effort of the gear that caught it.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="../reference/plotFMort.html">plotFMort</a></span>(<span class="no">sim</span>)</pre></body></html></div>
<p><img src="running_a_simulation_files/figure-html/plotFMort-1.png" width="700"></p>
</div>
<div id="an-example-of-changing-effort-through-time" class="section level3">
<h3 class="hasAnchor">
<a href="#an-example-of-changing-effort-through-time" class="anchor"></a>An example of changing effort through time</h3>
<p>In this example we set up a more complicated fishing effort structure that allows the fishing effort of each gear to change through time. As mentioned above, to do this, effort must be supplied as a two dimensional array or matrix. The first dimension is time and the second dimension is gear. The dimensions must be named. The gear names must match the gears in the <code>MizerParams</code> object. Also, as mentioned above, if effort is passed in as an array then the length of the simulation is determined by the time dimension names and the argument <code>t_max</code> is not used. Instead the simulation runs from the earliest time in the effort array to the latest.</p>
<p>In this example, we will project forward from time <span class="math inline">\(t=1\)</span> to time <span class="math inline">\(t=10\)</span>. The effort of the industrial gear is held constant at 0.5, the effort of the pelagic gear is increased linearly from 1 to 2, the effort of the beam trawl decreases linearly from 1 to 0, whilst the effort of the otter trawl decreases linearly from 1 to 0.5.</p>
<p>First we create the empty <code>effort</code> array:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">gear_names</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Industrial"</span>,<span class="st">"Pelagic"</span>,<span class="st">"Beam"</span>,<span class="st">"Otter"</span>)
<span class="no">times</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fl">1</span>)
<span class="no">effort_array</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fl">NA</span>, <span class="kw">dim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">times</span>), <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">gear_names</span>)),
    <span class="kw">dimnames</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">time</span> <span class="kw">=</span> <span class="no">times</span>, <span class="kw">gear</span> <span class="kw">=</span> <span class="no">gear_names</span>))</pre></body></html></div>
<p>Then we fill it up, one gear at a time, making heavy use of the <code><a href="https://rdrr.io/r/base/seq.html">seq()</a></code> function to create a sequence:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">effort_array</span>[,<span class="st">"Industrial"</span>] <span class="kw">&lt;-</span> <span class="fl">0.5</span>
<span class="no">effort_array</span>[,<span class="st">"Pelagic"</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">length</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">times</span>))
<span class="no">effort_array</span>[,<span class="st">"Beam"</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">length</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">times</span>))
<span class="no">effort_array</span>[,<span class="st">"Otter"</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">length</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">times</span>))</pre></body></html></div>
<p>The first few rows of the effort array are shown as an illustration:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">effort_array</span>)</pre></body></html></div>
<pre><code>##     gear
## time Industrial  Pelagic      Beam     Otter
##    1        0.5 1.000000 1.0000000 1.0000000
##    2        0.5 1.111111 0.8888889 0.9444444
##    3        0.5 1.222222 0.7777778 0.8888889
##    4        0.5 1.333333 0.6666667 0.8333333
##    5        0.5 1.444444 0.5555556 0.7777778
##    6        0.5 1.555556 0.4444444 0.7222222</code></pre>
<p>The first row gives the effort between times 1 and 2, the second between times 2 and 3, and so on. The time 10 row in the array is not actually used, except to set the final time for the simulation.</p>
<p>Now we can use this effort array in the projection:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span>(<span class="no">NS_params</span>, <span class="kw">effort</span> <span class="kw">=</span> <span class="no">effort_array</span>, <span class="kw">dt</span> <span class="kw">=</span> <span class="fl">0.1</span>, <span class="kw">t_save</span> <span class="kw">=</span> <span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">sim</span>@<span class="kw">effort</span>)</pre></body></html></div>
<pre><code>##     gear
## time Industrial  Pelagic      Beam     Otter
##    1        0.5 1.000000 1.0000000 1.0000000
##    2        0.5 1.111111 0.8888889 0.9444444
##    3        0.5 1.222222 0.7777778 0.8888889
##    4        0.5 1.333333 0.6666667 0.8333333
##    5        0.5 1.444444 0.5555556 0.7777778
##    6        0.5 1.555556 0.4444444 0.7222222</code></pre>
<p>As you can see, it can be quite fiddly to set up a complicated effort array so it may be easier to prepare it in advance as a .csv file and read it in, similar to how we read in the interaction matrix in <a href="multispecies_model.html#sec:params_example">the section with an examples of making a MizerParams object.</a> We give an example of this in <a href="a_multispecies_model_of_the_north_sea.html">the section on the North Sea model.</a></p>
<p>Note that in this example we set up the effort array so that the effort was set every whole time step (e.g. time = 1, 2, etc). This does not have to be the case and it is possible to set the effort more frequently than that, e.g. at time = 1.0, 1.5, 2.0, 2.5 etc. The only restriction is that the difference between time dimension names must be at least as big as the <code>dt</code> argument.</p>
<p>Now that we know how to run a simulation, the we are ready to learn how to <a href="exploring_the_simulation_results.html">explore the simulation results.</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.york.ac.uk/maths/staff/gustav-delius/">Gustav Delius</a>, Finlay Scott, <a href="http://www.utas.edu.au/profiles/staff/imas/julia-blanchard">Julia Blanchard</a>, <a href="https://ken.haste.dk/">Ken Andersen</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
